const e="object"==typeof self?self:globalThis,t=t=>((t,s)=>{const n=(e,s)=>(t.set(s,e),e),r=o=>{if(t.has(o))return t.get(o);const[a,c]=s[o];switch(a){case 0:case-1:return n(c,o);case 1:{const e=n([],o);for(const t of c)e.push(r(t));return e}case 2:{const e=n({},o);for(const[t,s]of c)e[r(t)]=r(s);return e}case 3:return n(new Date(c),o);case 4:{const{source:e,flags:t}=c;return n(new RegExp(e,t),o)}case 5:{const e=n(new Map,o);for(const[t,s]of c)e.set(r(t),r(s));return e}case 6:{const e=n(new Set,o);for(const t of c)e.add(r(t));return e}case 7:{const{name:t,message:s}=c;return n(new e[t](s),o)}case 8:return n(BigInt(c),o);case"BigInt":return n(Object(BigInt(c)),o)}return n(new e[a](c),o)};return r})(new Map,t)(0),s="",{toString:n}={},{keys:r}=Object,o=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const r=n.call(e).slice(8,-1);switch(r){case"Array":return[1,s];case"Object":return[2,s];case"Date":return[3,s];case"RegExp":return[4,s];case"Map":return[5,s];case"Set":return[6,s]}return r.includes("Array")?[1,r]:r.includes("Error")?[7,r]:[2,r]},a=([e,t])=>0===e&&("function"===t||"symbol"===t),c=(e,{json:t,lossy:s}={})=>{const n=[];return((e,t,s,n)=>{const c=(e,t)=>{const r=n.push(e)-1;return s.set(t,r),r},i=n=>{if(s.has(n))return s.get(n);let[u,f]=o(n);switch(u){case 0:{let t=n;switch(f){case"bigint":u=8,t=n.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);t=null;break;case"undefined":return c([-1],n)}return c([u,t],n)}case 1:{if(f)return c([f,[...n]],n);const e=[],t=c([u,e],n);for(const t of n)e.push(i(t));return t}case 2:{if(f)switch(f){case"BigInt":return c([f,n.toString()],n);case"Boolean":case"Number":case"String":return c([f,n.valueOf()],n)}if(t&&"toJSON"in n)return i(n.toJSON());const s=[],l=c([u,s],n);for(const t of r(n))!e&&a(o(n[t]))||s.push([i(t),i(n[t])]);return l}case 3:return c([u,n.toISOString()],n);case 4:{const{source:e,flags:t}=n;return c([u,{source:e,flags:t}],n)}case 5:{const t=[],s=c([u,t],n);for(const[s,r]of n)(e||!a(o(s))&&!a(o(r)))&&t.push([i(s),i(r)]);return s}case 6:{const t=[],s=c([u,t],n);for(const s of n)!e&&a(o(s))||t.push(i(s));return s}}const{message:l}=n;return c([u,{name:f,message:l}],n)};return i})(!(t||s),!!t,new Map,n)(e),n},{parse:i,stringify:u}=JSON,f={json:!0,lossy:!0};var l=Object.freeze({__proto__:null,parse:e=>t(i(e)),stringify:e=>u(c(e,f))});const g="function",p="566fc334-5147-4e86-bb9b-c7d24c13127d",w="get",d="has",h="set",{isArray:y}=Array;let{SharedArrayBuffer:b,window:m}=globalThis,{notify:E,wait:S,waitAsync:M}=Atomics,A=null;M||(M=e=>({value:new Promise((t=>{let s=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");s.onmessage=t,s.postMessage(e)}))}));try{new b(4)}catch(e){b=ArrayBuffer;const t=new WeakMap;if(m){const e=new Map,{prototype:{postMessage:s}}=Worker,n=t=>{const s=t.data?.[p];if(!y(s)){t.stopImmediatePropagation();const{id:n,sb:r}=s;e.get(n)(r)}};A=function(e,...r){const o=e?.[p];if(y(o)){const[e,s]=o;t.set(s,e),this.addEventListener("message",n)}return s.call(this,e,...r)},M=s=>({value:new Promise((n=>{e.set(t.get(s),n)})).then((n=>{e.delete(t.get(s)),t.delete(s);for(let e=0;e<n.length;e++)s[e]=n[e];return"ok"}))})}else{const e=(e,t)=>({[p]:{id:e,sb:t}});E=s=>{postMessage(e(t.get(s),s))},addEventListener("message",(e=>{const s=e.data?.[p];if(y(s)){const[e,n]=s;t.set(n,e)}}))}}
/*! (c) Andrea Giammarchi - ISC */const{Int32Array:v,Map:O,Uint16Array:T}=globalThis,{BYTES_PER_ELEMENT:k}=v,{BYTES_PER_ELEMENT:B}=T,j=new WeakSet,N=new WeakMap,_={value:{then:e=>e()}};let I=0;const P=(e,{parse:t=JSON.parse,stringify:s=JSON.stringify,transform:n,interrupt:r}=JSON)=>{if(!N.has(e)){const o=A||e.postMessage,a=(t,...s)=>o.call(e,{[p]:s},{transfer:t}),c=typeof r===g?r:r?.handler,i=r?.delay||42,u=new TextDecoder("utf-16"),f=(e,t)=>e?M(t,0):(c?((e,t,s)=>{for(;"timed-out"===S(e,0,0,t);)s()})(t,i,c):S(t,0),_);let l=!1;N.set(e,new Proxy(new O,{[d]:(e,t)=>"string"==typeof t&&!t.startsWith("_"),[w]:(s,r)=>"then"===r?null:(...s)=>{const o=I++;let c=new v(new b(2*k)),i=[];j.has(s.at(-1)||i)&&j.delete(i=s.pop()),a(i,o,c,r,n?s.map(n):s);const g=e!==globalThis;let p=0;return l&&g&&(p=setTimeout(console.warn,1e3,`ðŸ’€ðŸ”’ - Possible deadlock if proxy.${r}(...args) is awaited`)),f(g,c).value.then((()=>{clearTimeout(p);const e=c[1];if(!e)return;const s=B*e;return c=new v(new b(s+s%k)),a([],o,c),f(g,c).value.then((()=>t(u.decode(new T(c.buffer).slice(0,e)))))}))},[h](t,r,o){const a=typeof o;if(a!==g)throw new Error(`Unable to assign ${r} as ${a}`);if(!t.size){const r=new O;e.addEventListener("message",(async e=>{const o=e.data?.[p];if(y(o)){e.stopImmediatePropagation();const[a,c,...i]=o;let u;if(i.length){const[e,o]=i;if(t.has(e)){l=!0;try{const i=await t.get(e)(...o);if(void 0!==i){const e=s(n?n(i):i);r.set(a,e),c[1]=e.length}}catch(e){u=e}finally{l=!1}}else u=new Error(`Unsupported action: ${e}`);c[0]=1}else{const e=r.get(a);r.delete(a);for(let t=new T(c.buffer),s=0;s<e.length;s++)t[s]=e.charCodeAt(s)}if(E(c,0),u)throw u}}))}return!!t.set(r,o)}}))}return N.get(e)},x=(e,t)=>P(e,{...l,...t});x.transfer=P.transfer=(...e)=>(j.add(e),e);export{x as default};
