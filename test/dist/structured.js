const e="object"==typeof self?self:globalThis,t=t=>((t,s)=>{const r=(e,s)=>(t.set(s,e),e),n=a=>{if(t.has(a))return t.get(a);const[o,c]=s[a];switch(o){case 0:case-1:return r(c,a);case 1:{const e=r([],a);for(const t of c)e.push(n(t));return e}case 2:{const e=r({},a);for(const[t,s]of c)e[n(t)]=n(s);return e}case 3:return r(new Date(c),a);case 4:{const{source:e,flags:t}=c;return r(new RegExp(e,t),a)}case 5:{const e=r(new Map,a);for(const[t,s]of c)e.set(n(t),n(s));return e}case 6:{const e=r(new Set,a);for(const t of c)e.add(n(t));return e}case 7:{const{name:t,message:s}=c;return r(new e[t](s),a)}case 8:return r(BigInt(c),a);case"BigInt":return r(Object(BigInt(c)),a)}return r(new e[o](c),a)};return n})(new Map,t)(0),s="",{toString:r}={},{keys:n}=Object,a=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const n=r.call(e).slice(8,-1);switch(n){case"Array":return[1,s];case"Object":return[2,s];case"Date":return[3,s];case"RegExp":return[4,s];case"Map":return[5,s];case"Set":return[6,s]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},o=([e,t])=>0===e&&("function"===t||"symbol"===t),c=(e,{json:t,lossy:s}={})=>{const r=[];return((e,t,s,r)=>{const c=(e,t)=>{const n=r.push(e)-1;return s.set(t,n),n},i=r=>{if(s.has(r))return s.get(r);let[u,f]=a(r);switch(u){case 0:{let t=r;switch(f){case"bigint":u=8,t=r.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);t=null;break;case"undefined":return c([-1],r)}return c([u,t],r)}case 1:{if(f)return c([f,[...r]],r);const e=[],t=c([u,e],r);for(const t of r)e.push(i(t));return t}case 2:{if(f)switch(f){case"BigInt":return c([f,r.toString()],r);case"Boolean":case"Number":case"String":return c([f,r.valueOf()],r)}if(t&&"toJSON"in r)return i(r.toJSON());const s=[],l=c([u,s],r);for(const t of n(r))!e&&o(a(r[t]))||s.push([i(t),i(r[t])]);return l}case 3:return c([u,r.toISOString()],r);case 4:{const{source:e,flags:t}=r;return c([u,{source:e,flags:t}],r)}case 5:{const t=[],s=c([u,t],r);for(const[s,n]of r)(e||!o(a(s))&&!o(a(n)))&&t.push([i(s),i(n)]);return s}case 6:{const t=[],s=c([u,t],r);for(const s of r)!e&&o(a(s))||t.push(i(s));return s}}const{message:l}=r;return c([u,{name:f,message:l}],r)};return i})(!(t||s),!!t,new Map,r)(e),r},{parse:i,stringify:u}=JSON,f={json:!0,lossy:!0};var l=Object.freeze({__proto__:null,parse:e=>t(i(e)),stringify:e=>u(c(e,f))});const g="function",p="453c2f8b-9a5b-47f8-81f8-6e865d417c8d";var w=e=>({value:new Promise((t=>{let s=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");s.onmessage=t,s.postMessage(e)}))})
/*! (c) Andrea Giammarchi - ISC */;const{Int32Array:h,Map:d,SharedArrayBuffer:y,Uint16Array:b}=globalThis,{BYTES_PER_ELEMENT:m}=h,{BYTES_PER_ELEMENT:E}=b,{isArray:S}=Array,{notify:A,wait:O,waitAsync:M}=Atomics,T=new WeakSet,v=new WeakMap,j={value:{then:e=>e()}};let B=0;const N=(e,{parse:t=JSON.parse,stringify:s=JSON.stringify,transform:r,interrupt:n}=JSON)=>{if(!v.has(e)){const a=(t,...s)=>e.postMessage({[p]:s},{transfer:t}),o=typeof n===g?n:n?.handler,c=n?.delay||42,i=new TextDecoder("utf-16"),u=(e,t)=>e?(M||w)(t,0):(o?((e,t,s)=>{for(;"timed-out"===O(e,0,0,t);)s()})(t,c,o):O(t,0),j);let f=!1;v.set(e,new Proxy(new d,{has:(e,t)=>"string"==typeof t&&!t.startsWith("_"),get:(s,n)=>"then"===n?null:(...s)=>{const o=B++;let c=new h(new y(2*m)),l=[];T.has(s.at(-1)||l)&&T.delete(l=s.pop()),a(l,o,c,n,r?s.map(r):s);const g=e!==globalThis;let p=0;return f&&g&&(p=setTimeout(console.warn,1e3,`ðŸ’€ðŸ”’ - Possible deadlock if proxy.${n}(...args) is awaited`)),u(g,c).value.then((()=>{clearTimeout(p);const e=c[1];if(!e)return;const s=E*e;return c=new h(new y(s+s%m)),a([],o,c),u(g,c).value.then((()=>t(i.decode(new b(c.buffer).slice(0,e)))))}))},set(t,n,a){const o=typeof a;if(o!==g)throw new Error(`Unable to assign ${n} as ${o}`);if(!t.size){const n=new d;e.addEventListener("message",(async e=>{const a=e.data?.[p];if(S(a)){e.stopImmediatePropagation();const[o,c,...i]=a;let u;if(i.length){const[e,a]=i;if(t.has(e)){f=!0;try{const i=await t.get(e)(...a);if(void 0!==i){const e=s(r?r(i):i);n.set(o,e),c[1]=e.length}}catch(e){u=e}finally{f=!1}}else u=new Error(`Unsupported action: ${e}`);c[0]=1}else{const e=n.get(o);n.delete(o);for(let t=new b(c.buffer),s=0;s<e.length;s++)t[s]=e.charCodeAt(s)}if(A(c,0),u)throw u}}))}return!!t.set(n,a)}}))}return v.get(e)},_=(e,t)=>N(e,{...l,...t});_.transfer=N.transfer=(...e)=>(T.add(e),e);export{_ as default};
