Promise.withResolvers||(Promise.withResolvers=function(){var e,t,r=new this((function(r,n){e=r,t=n}));return{resolve:e,reject:t,promise:r}});const e="accd2f68-43c8-49a2-a3cd-6685ed815ecb",t="M"+e,r="T"+e,n="apply",s="construct",o="defineProperty",a="deleteProperty",c="get",i="getOwnPropertyDescriptor",u="getPrototypeOf",f="has",l="isExtensible",p="ownKeys",g="preventExtensions",y="set",w="setPrototypeOf",h="delete",d="object",m="function",b="number",v="string",E="undefined",S="symbol",{defineProperty:M,getOwnPropertyDescriptor:P,getPrototypeOf:k,isExtensible:A,ownKeys:O,preventExtensions:x,set:T,setPrototypeOf:R}=Reflect,{assign:j,create:W}=Object,B=k(Int8Array),_="isArray",I=(e,t)=>{const{get:r,set:n,value:s}=e;return r&&(e.get=t(r)),n&&(e.set=t(n)),s&&(e.value=t(s)),e},L=(e,t)=>[e,t],C=e=>t=>{const r=typeof t;switch(r){case d:if(null==t)return L("null",t);case m:return e(r,t);case"boolean":case b:case v:case E:case"bigint":return L(r,t);case S:if(D.has(t))return L(r,D.get(t))}throw new Error(`Unable to handle this ${r} type`)},D=new Map(O(Symbol).filter((e=>typeof Symbol[e]===S)).map((e=>[Symbol[e],e]))),N=e=>{for(const[t,r]of D)if(r===e)return t};function z(){return this}const $="object"==typeof self?self:globalThis,J=e=>((e,t)=>{const r=(t,r)=>(e.set(r,t),t),n=s=>{if(e.has(s))return e.get(s);const[o,a]=t[s];switch(o){case 0:case-1:return r(a,s);case 1:{const e=r([],s);for(const t of a)e.push(n(t));return e}case 2:{const e=r({},s);for(const[t,r]of a)e[n(t)]=n(r);return e}case 3:return r(new Date(a),s);case 4:{const{source:e,flags:t}=a;return r(new RegExp(e,t),s)}case 5:{const e=r(new Map,s);for(const[t,r]of a)e.set(n(t),n(r));return e}case 6:{const e=r(new Set,s);for(const t of a)e.add(n(t));return e}case 7:{const{name:e,message:t}=a;return r(new $[e](t),s)}case 8:return r(BigInt(a),s);case"BigInt":return r(Object(BigInt(a)),s)}return r(new $[o](a),s)};return n})(new Map,e)(0),U="",{toString:F}={},{keys:K}=Object,Y=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const r=F.call(e).slice(8,-1);switch(r){case"Array":return[1,U];case"Object":return[2,U];case"Date":return[3,U];case"RegExp":return[4,U];case"Map":return[5,U];case"Set":return[6,U]}return r.includes("Array")?[1,r]:r.includes("Error")?[7,r]:[2,r]},q=([e,t])=>0===e&&("function"===t||"symbol"===t),G=(e,{json:t,lossy:r}={})=>{const n=[];return((e,t,r,n)=>{const s=(e,t)=>{const s=n.push(e)-1;return r.set(t,s),s},o=n=>{if(r.has(n))return r.get(n);let[a,c]=Y(n);switch(a){case 0:{let t=n;switch(c){case"bigint":a=8,t=n.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+c);t=null;break;case"undefined":return s([-1],n)}return s([a,t],n)}case 1:{if(c)return s([c,[...n]],n);const e=[],t=s([a,e],n);for(const t of n)e.push(o(t));return t}case 2:{if(c)switch(c){case"BigInt":return s([c,n.toString()],n);case"Boolean":case"Number":case"String":return s([c,n.valueOf()],n)}if(t&&"toJSON"in n)return o(n.toJSON());const r=[],i=s([a,r],n);for(const t of K(n))!e&&q(Y(n[t]))||r.push([o(t),o(n[t])]);return i}case 3:return s([a,n.toISOString()],n);case 4:{const{source:e,flags:t}=n;return s([a,{source:e,flags:t}],n)}case 5:{const t=[],r=s([a,t],n);for(const[r,s]of n)(e||!q(Y(r))&&!q(Y(s)))&&t.push([o(r),o(s)]);return r}case 6:{const t=[],r=s([a,t],n);for(const r of n)!e&&q(Y(r))||t.push(o(r));return r}}const{message:i}=n;return s([a,{name:c,message:i}],n)};return o})(!(t||r),!!t,new Map,n)(e),n},{parse:H,stringify:Q}=JSON,V={json:!0,lossy:!0};var X=Object.freeze({__proto__:null,parse:e=>J(H(e)),stringify:e=>Q(G(e,V))}),Z=e=>({value:new Promise((t=>{let r=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");r.onmessage=t,r.postMessage(e)}))})
/*! (c) Andrea Giammarchi - ISC */;const{Int32Array:ee,Map:te,SharedArrayBuffer:re,Uint16Array:ne}=globalThis,{BYTES_PER_ELEMENT:se}=ee,{BYTES_PER_ELEMENT:oe}=ne,{isArray:ae}=Array,{notify:ce,wait:ie,waitAsync:ue}=Atomics,{fromCharCode:fe}=String,le=(e,t)=>e?(ue||Z)(t,0):(ie(t,0),{value:{then:e=>e()}}),pe=new WeakSet,ge=new WeakMap;let ye=0;const we=(t,{parse:r,stringify:n}=JSON)=>{if(!ge.has(t)){const s=(r,...n)=>t.postMessage({[e]:n},{transfer:r});ge.set(t,new Proxy(new te,{has:(e,t)=>"string"==typeof t&&!t.startsWith("_"),get:(e,n)=>"then"===n?null:(...e)=>{const o=ye++;let a=new ee(new re(se)),c=[];pe.has(e.at(-1)||c)&&pe.delete(c=e.pop()),s(c,o,a,n,e);const i=t instanceof Worker;return le(i,a).value.then((()=>{const e=a[0];if(!e)return;const t=oe*e;return a=new ee(new re(t+t%se)),s([],o,a),le(i,a).value.then((()=>r(fe(...new ne(a.buffer).slice(0,e)))))}))},set(r,s,o){if(!r.size){const s=new te;t.addEventListener("message",(async t=>{const o=t.data?.[e];if(ae(o)){t.stopImmediatePropagation();const[e,a,...c]=o;if(c.length){const[t,o]=c;if(!r.has(t))throw new Error(`Unsupported action: ${t}`);{const c=n(await r.get(t)(...o));c&&(s.set(e,c),a[0]=c.length)}}else{const t=s.get(e);s.delete(e);for(let e=new ne(a.buffer),r=0;r<t.length;r++)e[r]=t.charCodeAt(r)}ce(a,0)}}))}return!!r.set(s,o)}}))}return ge.get(t)},he=e=>we(e,X);he.transfer=we.transfer=(...e)=>(pe.add(e),e);var de=(e,t)=>{let r=0;const _=new Map,D=new Map,z=t&&new WeakMap;if(t){const{addEventListener:e}=EventTarget.prototype;M(EventTarget.prototype,"addEventListener",{value(t,r,...n){return n.at(0)?.invoke&&(z.has(this)||z.set(this,new Map),z.get(this).set(t,[].concat(n[0].invoke)),delete n[0].invoke),e.call(this,t,r,...n)}})}const $=t&&(e=>{const{currentTarget:t,target:r,type:n}=e;for(const s of z.get(t||r)?.get(n)||[])e[s]()}),J=C(((e,t)=>{if(!_.has(t)){let e;for(;D.has(e=r++););_.set(t,e),D.set(e,t)}return L(e,_.get(t))}));return(r,C,z,...U)=>{const{[z]:F}=r,K=U.length?j(W(globalThis),...U):globalThis,Y=new FinalizationRegistry((e=>{F(h,L(v,e))})),q=([e,r])=>{switch(e){case d:if(null==r)return K;if(typeof r===b)return D.get(r);if(!(r instanceof B))for(const e in r)r[e]=q(r[e]);return r;case m:if(typeof r===v){if(!D.has(r)){const e=function(...e){return t&&e.at(0)instanceof Event&&$(...e),F(n,L(m,r),J(this),e.map(J))},s=new WeakRef(e);D.set(r,s),Y.register(e,r,s)}return D.get(r).deref()}return D.get(r);case S:return N(r)}return r},G={[n]:(e,t,r)=>J(e.apply(t,r)),[s]:(e,t)=>J(new e(...t)),[o]:(e,t,r)=>J(M(e,t,r)),[a]:(e,t)=>J(delete e[t]),[u]:e=>J(k(e)),[c]:(e,t)=>J(e[t]),[i]:(e,t)=>{const r=P(e,t);return r?L(d,I(r,J)):L(E,r)},[f]:(e,t)=>J(t in e),[l]:e=>J(A(e)),[p]:e=>L(d,O(e).map(J)),[g]:e=>J(x(e)),[y]:(e,t,r)=>J(T(e,t,r)),[w]:(e,t)=>J(R(e,t)),[h](e){_.delete(D.get(e)),D.delete(e)}};return r[C]=(e,t,...r)=>{switch(e){case n:r[0]=q(r[0]),r[1]=r[1].map(q);break;case s:r[0]=r[0].map(q);break;case o:{const[e,t]=r;r[0]=q(e);const{get:n,set:s,value:o}=t;n&&(t.get=q(n)),s&&(t.set=q(s)),o&&(t.value=q(o));break}default:r=r.map(q)}return G[e](q(t),...r)},{proxy:r,[e.toLowerCase()]:K,[`is${e}Proxy`]:()=>!1}}},me=de("Window",!0),be=e=>{let t=0;const r=new Map,E=new Map,P=Symbol(),k=e=>typeof e===m?e():e,A=e=>typeof e===d&&!!e&&P in e,O=Array[_],x=C(((e,n)=>{if(P in n)return k(n[P]);if(e===m){if(!E.has(n)){let e;for(;E.has(e=String(t++)););r.set(n,e),E.set(e,n)}return L(e,r.get(n))}if(!(n instanceof B))for(const e in n)n[e]=x(n[e]);return L(e,n)}));return(t,T,R)=>{const{[T]:j}=t,W=new Map,B=new FinalizationRegistry((e=>{W.delete(e),j(h,x(e))})),L=e=>{const[t,r]=e;if(!W.has(r)){const n=t===m?z.bind(e):e,s=new Proxy(n,$),o=new WeakRef(s);W.set(r,o),B.register(s,r,o)}return W.get(r).deref()},C=e=>{const[t,r]=e;switch(t){case d:return typeof r===b?L(e):r;case m:return typeof r===v?E.get(r):L(e);case S:return N(r)}return r},D=(e,t,...r)=>C(j(e,k(t),...r)),$={[n]:(e,t,r)=>D(n,e,x(t),r.map(x)),[s]:(e,t)=>D(s,e,t.map(x)),[o]:(e,t,r)=>{const{get:n,set:s,value:a}=r;return typeof n===m&&(r.get=x(n)),typeof s===m&&(r.set=x(s)),typeof a===m&&(r.value=x(a)),D(o,e,x(t),r)},[a]:(e,t)=>D(a,e,x(t)),[u]:e=>D(u,e),[c]:(e,t)=>t===P?e:D(c,e,x(t)),[i]:(e,t)=>{const r=D(i,e,x(t));return r&&I(r,C)},[f]:(e,t)=>t===P||D(f,e,x(t)),[l]:e=>D(l,e),[p]:e=>D(p,e).map(C),[g]:e=>D(g,e),[y]:(e,t,r)=>D(y,e,x(t),x(r)),[w]:(e,t)=>D(w,e,x(t))};t[R]=(e,t,s,o)=>{switch(e){case n:return C(t).apply(C(s),o.map(C));case h:{const e=C(t);r.delete(E.get(e)),E.delete(e)}}};const J=new Proxy([d,null],$),U=J.Array[_];return M(Array,_,{value:e=>A(e)?U(e):O(e)}),{[e.toLowerCase()]:J,[`is${e}Proxy`]:A,proxy:t}}},ve=be("Window"),Ee=de("Server",!1),Se=be("Server");const Me="S"+t,Pe="S"+r,{parse:ke,stringify:Ae}=X,Oe=!!globalThis.process,xe=new WeakMap,Te=e=>{let t="";return/^!(-?\d+)/.test(e)&&(t=RegExp.$1,e=e.slice(1+t.length)),{id:t,result:e?ke(e):void 0}},Re=Oe?(e,t)=>{let r,s=0;const o=new Map,a=Ee({[Pe]:async(e,...t)=>{const a=Ae([e,...t]);if(e===n){const{promise:e,resolve:t}=Promise.withResolvers(),n=String(s++);return o.set(n,t),r.send("!"+n+a),await e}r.send("!"+a)}},Me,Pe,t),c=a.proxy[Me];return e.on("connection",(e=>{r=e.on("close",(()=>{for(const[e,t]of o)t();o.clear()})).on("message",(e=>{const{id:t,result:n}=Te(String(e));if(t){const e=o.get(t);o.delete(t),e(n)}else r.send(Ae(c(...n)))}))}))}:(e,n)=>{const s=he(e);if(!xe.has(s)){const o=e instanceof Worker?je:We;xe.set(s,o(s,t,r,n))}return xe.get(s)};Oe||(Re.transfer=he.transfer);const je=(e,t,r,n)=>{let s;const{[Pe]:o}=e;return n.addEventListener("message",(async({data:e})=>{const{id:t,result:r}=Te(e);if(t){const e=await o(...r);n.send("!"+t+(void 0===e?"":Ae(e)))}else s=s(r)})),e[Me]=(...e)=>new Promise((t=>{s=t,n.send(Ae(e))})),me(e,t,r)},We=(e,t,r)=>j(Se(e,Me,Pe),ve(e,t,r));export{Re as default};
