const e="59dda6ee-e1ec-47af-ade9-33b38891797a",t="M"+e,n="T"+e,r="object",s="function",o="number",a="string",c="undefined",i="symbol",{defineProperty:u,getOwnPropertyDescriptor:f,getPrototypeOf:l,isExtensible:p,ownKeys:g,preventExtensions:y,set:w,setPrototypeOf:h}=Reflect,{assign:d,create:b}=Object,m=l(Int8Array),v="isArray",E=(e,t)=>{const{get:n,set:r,value:s}=e;return n&&(e.get=t(n)),r&&(e.set=t(r)),s&&(e.value=t(s)),e},S=(e,t)=>[e,t],M=e=>t=>{const n=typeof t;switch(n){case r:if(null==t)return S("null",t);case s:return e(n,t);case"boolean":case o:case a:case c:case"bigint":return S(n,t);case i:if(P.has(t))return S(n,P.get(t))}throw new Error(`Unable to handle this ${n} type`)},P=new Map(g(Symbol).filter((e=>typeof Symbol[e]===i)).map((e=>[Symbol[e],e]))),k=e=>{for(const[t,n]of P)if(n===e)return t};function A(){return this}const O="object"==typeof self?self:globalThis,x=e=>((e,t)=>{const n=(t,n)=>(e.set(n,t),t),r=s=>{if(e.has(s))return e.get(s);const[o,a]=t[s];switch(o){case 0:case-1:return n(a,s);case 1:{const e=n([],s);for(const t of a)e.push(r(t));return e}case 2:{const e=n({},s);for(const[t,n]of a)e[r(t)]=r(n);return e}case 3:return n(new Date(a),s);case 4:{const{source:e,flags:t}=a;return n(new RegExp(e,t),s)}case 5:{const e=n(new Map,s);for(const[t,n]of a)e.set(r(t),r(n));return e}case 6:{const e=n(new Set,s);for(const t of a)e.add(r(t));return e}case 7:{const{name:e,message:t}=a;return n(new O[e](t),s)}case 8:return n(BigInt(a),s);case"BigInt":return n(Object(BigInt(a)),s)}return n(new O[o](a),s)};return r})(new Map,e)(0),T="",{toString:W}={},{keys:j}=Object,B=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const n=W.call(e).slice(8,-1);switch(n){case"Array":return[1,T];case"Object":return[2,T];case"Date":return[3,T];case"RegExp":return[4,T];case"Map":return[5,T];case"Set":return[6,T]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},R=([e,t])=>0===e&&("function"===t||"symbol"===t),_=(e,{json:t,lossy:n}={})=>{const r=[];return((e,t,n,r)=>{const s=(e,t)=>{const s=r.push(e)-1;return n.set(t,s),s},o=r=>{if(n.has(r))return n.get(r);let[a,c]=B(r);switch(a){case 0:{let t=r;switch(c){case"bigint":a=8,t=r.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+c);t=null;break;case"undefined":return s([-1],r)}return s([a,t],r)}case 1:{if(c)return s([c,[...r]],r);const e=[],t=s([a,e],r);for(const t of r)e.push(o(t));return t}case 2:{if(c)switch(c){case"BigInt":return s([c,r.toString()],r);case"Boolean":case"Number":case"String":return s([c,r.valueOf()],r)}if(t&&"toJSON"in r)return o(r.toJSON());const n=[],i=s([a,n],r);for(const t of j(r))!e&&R(B(r[t]))||n.push([o(t),o(r[t])]);return i}case 3:return s([a,r.toISOString()],r);case 4:{const{source:e,flags:t}=r;return s([a,{source:e,flags:t}],r)}case 5:{const t=[],n=s([a,t],r);for(const[n,s]of r)(e||!R(B(n))&&!R(B(s)))&&t.push([o(n),o(s)]);return n}case 6:{const t=[],n=s([a,t],r);for(const n of r)!e&&R(B(n))||t.push(o(n));return n}}const{message:i}=r;return s([a,{name:c,message:i}],r)};return o})(!(t||n),!!t,new Map,r)(e),r},{parse:I,stringify:L}=JSON,C={json:!0,lossy:!0};var D=Object.freeze({__proto__:null,parse:e=>x(I(e)),stringify:e=>L(_(e,C))}),N=e=>({value:new Promise((t=>{let n=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");n.onmessage=t,n.postMessage(e)}))})
/*! (c) Andrea Giammarchi - ISC */;const{Int32Array:z,Map:J,SharedArrayBuffer:$,Uint16Array:U}=globalThis,{BYTES_PER_ELEMENT:F}=z,{BYTES_PER_ELEMENT:K}=U,{isArray:Y}=Array,{notify:q,wait:G,waitAsync:H}=Atomics,{fromCharCode:Q}=String,V=(e,t)=>e?(H||N)(t,0):(G(t,0),{value:{then:e=>e()}}),X=new WeakSet,Z=new WeakMap;let ee=0;const te=(t,{parse:n,stringify:r}=JSON)=>{if(!Z.has(t)){const s=(n,...r)=>t.postMessage({[e]:r},{transfer:n});Z.set(t,new Proxy(new J,{has:(e,t)=>"string"==typeof t&&!t.startsWith("_"),get:(e,r)=>"then"===r?null:(...e)=>{const o=ee++;let a=new z(new $(F)),c=[];X.has(e.at(-1)||c)&&X.delete(c=e.pop()),s(c,o,a,r,e);const i=t instanceof Worker;return V(i,a).value.then((()=>{const e=a[0];if(!e)return;const t=K*e;return a=new z(new $(t+t%F)),s([],o,a),V(i,a).value.then((()=>n(Q(...new U(a.buffer).slice(0,e)))))}))},set(n,s,o){if(!n.size){const s=new J;t.addEventListener("message",(async t=>{const o=t.data?.[e];if(Y(o)){t.stopImmediatePropagation();const[e,a,...c]=o;if(c.length){const[t,o]=c;if(!n.has(t))throw new Error(`Unsupported action: ${t}`);{const c=r(await n.get(t)(...o));c&&(s.set(e,c),a[0]=c.length)}}else{const t=s.get(e);s.delete(e);for(let e=new U(a.buffer),n=0;n<t.length;n++)e[n]=t.charCodeAt(n)}q(a,0)}}))}return!!n.set(s,o)}}))}return Z.get(t)},ne=e=>te(e,D);ne.transfer=te.transfer=(...e)=>(X.add(e),e);const re="apply",se="construct",oe="defineProperty",ae="deleteProperty",ce="get",ie="getOwnPropertyDescriptor",ue="getPrototypeOf",fe="has",le="isExtensible",pe="ownKeys",ge="preventExtensions",ye="set",we="setPrototypeOf",he="delete";var de=(e,t)=>{let n=0;const v=new Map,P=new Map,A=t&&new WeakMap;if(t){const{addEventListener:e}=EventTarget.prototype;u(EventTarget.prototype,"addEventListener",{value(t,n,...r){return r.at(0)?.invoke&&(A.has(this)||A.set(this,new Map),A.get(this).set(t,[].concat(r[0].invoke)),delete r[0].invoke),e.call(this,t,n,...r)}})}const O=t&&(e=>{const{currentTarget:t,target:n,type:r}=e;for(const s of A.get(t||n)?.get(r)||[])e[s]()}),x=M(((e,t)=>{if(!v.has(t)){let e;for(;P.has(e=n++););v.set(t,e),P.set(e,t)}return S(e,v.get(t))}));return(n,M,A,...T)=>{const{[A]:W}=n,j=T.length?d(b(globalThis),...T):globalThis,B=new FinalizationRegistry((e=>{W(he,S(a,e))})),R=([e,n])=>{switch(e){case r:if(null==n)return j;if(typeof n===o)return P.get(n);if(!(n instanceof m))for(const e in n)n[e]=R(n[e]);return n;case s:if(typeof n===a){if(!P.has(n)){const e=function(...e){return t&&e.at(0)instanceof Event&&O(...e),W(re,S(s,n),x(this),e.map(x))},r=new WeakRef(e);P.set(n,r),B.register(e,n,r)}return P.get(n).deref()}return P.get(n);case i:return k(n)}return n},_={[re]:(e,t,n)=>x(e.apply(t,n)),[se]:(e,t)=>x(new e(...t)),[oe]:(e,t,n)=>x(u(e,t,n)),[ae]:(e,t)=>x(delete e[t]),[ue]:e=>x(l(e)),[ce]:(e,t)=>x(e[t]),[ie]:(e,t)=>{const n=f(e,t);return n?S(r,E(n,x)):S(c,n)},[fe]:(e,t)=>x(t in e),[le]:e=>x(p(e)),[pe]:e=>S(r,g(e).map(x)),[ge]:e=>x(y(e)),[ye]:(e,t,n)=>x(w(e,t,n)),[we]:(e,t)=>x(h(e,t)),[he](e){v.delete(P.get(e)),P.delete(e)}};return n[M]=(e,t,...n)=>{switch(e){case re:n[0]=R(n[0]),n[1]=n[1].map(R);break;case se:n[0]=n[0].map(R);break;case oe:{const[e,t]=n;n[0]=R(e);const{get:r,set:s,value:o}=t;r&&(t.get=R(r)),s&&(t.set=R(s)),o&&(t.value=R(o));break}default:n=n.map(R)}return _[e](R(t),...n)},{proxy:n,[e.toLowerCase()]:j,[`is${e}Proxy`]:()=>!1}}},be=de("Window",!0),me=e=>{let t=0;const n=new Map,c=new Map,f=Symbol(),l=e=>typeof e===s?e():e,p=e=>typeof e===r&&!!e&&f in e,g=Array[v],y=M(((e,r)=>{if(f in r)return l(r[f]);if(e===s){if(!c.has(r)){let e;for(;c.has(e=String(t++)););n.set(r,e),c.set(e,r)}return S(e,n.get(r))}if(!(r instanceof m))for(const e in r)r[e]=y(r[e]);return S(e,r)}));return(t,w,h)=>{const{[w]:d}=t,b=new Map,m=new FinalizationRegistry((e=>{b.delete(e),d(he,y(e))})),S=e=>{const[t,n]=e;if(!b.has(n)){const r=t===s?A.bind(e):e,o=new Proxy(r,O),a=new WeakRef(o);b.set(n,a),m.register(o,n,a)}return b.get(n).deref()},M=e=>{const[t,n]=e;switch(t){case r:return typeof n===o?S(e):n;case s:return typeof n===a?c.get(n):S(e);case i:return k(n)}return n},P=(e,t,...n)=>M(d(e,l(t),...n)),O={[re]:(e,t,n)=>P(re,e,y(t),n.map(y)),[se]:(e,t)=>P(se,e,t.map(y)),[oe]:(e,t,n)=>{const{get:r,set:o,value:a}=n;return typeof r===s&&(n.get=y(r)),typeof o===s&&(n.set=y(o)),typeof a===s&&(n.value=y(a)),P(oe,e,y(t),n)},[ae]:(e,t)=>P(ae,e,y(t)),[ue]:e=>P(ue,e),[ce]:(e,t)=>t===f?e:P(ce,e,y(t)),[ie]:(e,t)=>{const n=P(ie,e,y(t));return n&&E(n,M)},[fe]:(e,t)=>t===f||P(fe,e,y(t)),[le]:e=>P(le,e),[pe]:e=>P(pe,e).map(M),[ge]:e=>P(ge,e),[ye]:(e,t,n)=>P(ye,e,y(t),y(n)),[we]:(e,t)=>P(we,e,y(t))};t[h]=(e,t,r,s)=>{switch(e){case re:return M(t).apply(M(r),s.map(M));case he:{const e=M(t);n.delete(c.get(e)),c.delete(e)}}};const x=new Proxy([r,null],O),T=x.Array[v];return u(Array,v,{value:e=>p(e)?T(e):g(e)}),{[e.toLowerCase()]:x,[`is${e}Proxy`]:p,proxy:t}}},ve=me("Window"),Ee=de("Server",!1),Se=me("Server");const Me="S"+t,Pe="S"+n,{parse:ke,stringify:Ae}=D,Oe=!!globalThis.process,xe=new WeakMap,Te=Oe?(e,t)=>e.on("connection",(e=>{const n=Ee({[Pe]:(...t)=>{e.send("!"+Ae(t))}},Me,Pe,t).proxy[Me];e.on("message",(t=>{e.send(Ae(n(...ke(t))))}))})):(e,...r)=>{const s=ne(e);if(!xe.has(s)){const o=e instanceof Worker?We:je;xe.set(s,o(s,t,n,...r))}return xe.get(s)};Oe||(Te.transfer=ne.transfer);const We=(e,t,n,r)=>{const{[Pe]:s}=e;let o;return r.addEventListener("message",(async({data:e})=>{const t=e.startsWith("!"),n=ke(t?e.slice(1):e);t?s(...n):o=o(n)})),e[Me]=(...e)=>new Promise((t=>{o=t,r.send(Ae(e))})),be(e,t,n)},je=(e,t,n)=>d(Se(e,Me,Pe),ve(e,t,n));export{Te as default};
