const e="object"==typeof self?self:globalThis,t=t=>((t,n)=>{const r=(e,n)=>(t.set(n,e),e),s=c=>{if(t.has(c))return t.get(c);const[o,a]=n[c];switch(o){case 0:case-1:return r(a,c);case 1:{const e=r([],c);for(const t of a)e.push(s(t));return e}case 2:{const e=r({},c);for(const[t,n]of a)e[s(t)]=s(n);return e}case 3:return r(new Date(a),c);case 4:{const{source:e,flags:t}=a;return r(new RegExp(e,t),c)}case 5:{const e=r(new Map,c);for(const[t,n]of a)e.set(s(t),s(n));return e}case 6:{const e=r(new Set,c);for(const t of a)e.add(s(t));return e}case 7:{const{name:t,message:n}=a;return r(new e[t](n),c)}case 8:return r(BigInt(a),c);case"BigInt":return r(Object(BigInt(a)),c)}return r(new e[o](a),c)};return s})(new Map,t)(0),n="",{toString:r}={},{keys:s}=Object,c=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const s=r.call(e).slice(8,-1);switch(s){case"Array":return[1,n];case"Object":return[2,n];case"Date":return[3,n];case"RegExp":return[4,n];case"Map":return[5,n];case"Set":return[6,n]}return s.includes("Array")?[1,s]:s.includes("Error")?[7,s]:[2,s]},o=([e,t])=>0===e&&("function"===t||"symbol"===t),a=(e,{json:t,lossy:n}={})=>{const r=[];return((e,t,n,r)=>{const a=(e,t)=>{const s=r.push(e)-1;return n.set(t,s),s},u=r=>{if(n.has(r))return n.get(r);let[f,i]=c(r);switch(f){case 0:{let t=r;switch(i){case"bigint":f=8,t=r.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+i);t=null;break;case"undefined":return a([-1],r)}return a([f,t],r)}case 1:{if(i)return a([i,[...r]],r);const e=[],t=a([f,e],r);for(const t of r)e.push(u(t));return t}case 2:{if(i)switch(i){case"BigInt":return a([i,r.toString()],r);case"Boolean":case"Number":case"String":return a([i,r.valueOf()],r)}if(t&&"toJSON"in r)return u(r.toJSON());const n=[],l=a([f,n],r);for(const t of s(r))!e&&o(c(r[t]))||n.push([u(t),u(r[t])]);return l}case 3:return a([f,r.toISOString()],r);case 4:{const{source:e,flags:t}=r;return a([f,{source:e,flags:t}],r)}case 5:{const t=[],n=a([f,t],r);for(const[n,s]of r)(e||!o(c(n))&&!o(c(s)))&&t.push([u(n),u(s)]);return n}case 6:{const t=[],n=a([f,t],r);for(const n of r)!e&&o(c(n))||t.push(u(n));return n}}const{message:l}=r;return a([f,{name:i,message:l}],r)};return u})(!(t||n),!!t,new Map,r)(e),r},{parse:u,stringify:f}=JSON,i={json:!0,lossy:!0};var l=Object.freeze({__proto__:null,parse:e=>t(u(e)),stringify:e=>f(a(e,i))});
/*! (c) Andrea Giammarchi - ISC */const g="c85efda3-9cb0-445f-bf66-cc19f6c7a1f3",{Atomics:w,Int32Array:h,Map:p,SharedArrayBuffer:y,Uint16Array:d}=globalThis,{BYTES_PER_ELEMENT:b}=h,{BYTES_PER_ELEMENT:S}=d,{isArray:E}=Array,{notify:m,wait:A,waitAsync:O}=w,{fromCharCode:M}=String,j=(e,t)=>e?O(t,0):(A(t,0),{value:{then:e=>e()}}),B=new WeakSet,_=new WeakMap;let N=0;const T=(e,{parse:t,stringify:n}=JSON)=>{if(!_.has(e)){const r=(t,...n)=>e.postMessage({[g]:n},{transfer:t});_.set(e,new Proxy(new p,{get:(n,s)=>"then"===s?null:(...n)=>{const c=N++;let o=new y(b);const a=new h(o);let u=[];B.has(n.at(-1)||u)&&B.delete(u=n.pop()),r(u,c,o,s,n);const f=e instanceof Worker;return j(f,a).value.then((()=>{const e=a[0],n=S*e;return o=new y(n+n%b),r([],c,o),j(f,new h(o)).value.then((()=>t(M(...new d(o).slice(0,e)))))}))},set(t,r,s){if(!t.size){const r=new p;e.addEventListener("message",(async({data:e})=>{const s=e?.[g];if(E(s)){const[e,c,...o]=s,a=new h(c);if(o.length){const[s,c]=o;if(!t.has(s))throw new Error(`Unsupported action: ${s}`);{const o=n(await t.get(s)(...c));r.set(e,o),a[0]=o.length}}else{const t=r.get(e);r.delete(e);for(let e=new d(c),n=0;n<t.length;n++)e[n]=t.charCodeAt(n)}m(a,0)}}))}return!!t.set(r,s)}}))}return _.get(e)},k=e=>T(e,l);k.transfer=T.transfer=(...e)=>(B.add(e),e);export{k as default};
