const e="object"==typeof self?self:globalThis,t=t=>((t,n)=>{const s=(e,n)=>(t.set(n,e),e),r=a=>{if(t.has(a))return t.get(a);const[o,c]=n[a];switch(o){case 0:case-1:return s(c,a);case 1:{const e=s([],a);for(const t of c)e.push(r(t));return e}case 2:{const e=s({},a);for(const[t,n]of c)e[r(t)]=r(n);return e}case 3:return s(new Date(c),a);case 4:{const{source:e,flags:t}=c;return s(new RegExp(e,t),a)}case 5:{const e=s(new Map,a);for(const[t,n]of c)e.set(r(t),r(n));return e}case 6:{const e=s(new Set,a);for(const t of c)e.add(r(t));return e}case 7:{const{name:t,message:n}=c;return s(new e[t](n),a)}case 8:return s(BigInt(c),a);case"BigInt":return s(Object(BigInt(c)),a)}return s(new e[o](c),a)};return r})(new Map,t)(0),n="",{toString:s}={},{keys:r}=Object,a=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const r=s.call(e).slice(8,-1);switch(r){case"Array":return[1,n];case"Object":return[2,n];case"Date":return[3,n];case"RegExp":return[4,n];case"Map":return[5,n];case"Set":return[6,n]}return r.includes("Array")?[1,r]:r.includes("Error")?[7,r]:[2,r]},o=([e,t])=>0===e&&("function"===t||"symbol"===t),c=(e,{json:t,lossy:n}={})=>{const s=[];return((e,t,n,s)=>{const c=(e,t)=>{const r=s.push(e)-1;return n.set(t,r),r},u=s=>{if(n.has(s))return n.get(s);let[i,f]=a(s);switch(i){case 0:{let t=s;switch(f){case"bigint":i=8,t=s.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);t=null;break;case"undefined":return c([-1],s)}return c([i,t],s)}case 1:{if(f)return c([f,[...s]],s);const e=[],t=c([i,e],s);for(const t of s)e.push(u(t));return t}case 2:{if(f)switch(f){case"BigInt":return c([f,s.toString()],s);case"Boolean":case"Number":case"String":return c([f,s.valueOf()],s)}if(t&&"toJSON"in s)return u(s.toJSON());const n=[],l=c([i,n],s);for(const t of r(s))!e&&o(a(s[t]))||n.push([u(t),u(s[t])]);return l}case 3:return c([i,s.toISOString()],s);case 4:{const{source:e,flags:t}=s;return c([i,{source:e,flags:t}],s)}case 5:{const t=[],n=c([i,t],s);for(const[n,r]of s)(e||!o(a(n))&&!o(a(r)))&&t.push([u(n),u(r)]);return n}case 6:{const t=[],n=c([i,t],s);for(const n of s)!e&&o(a(n))||t.push(u(n));return n}}const{message:l}=s;return c([i,{name:f,message:l}],s)};return u})(!(t||n),!!t,new Map,s)(e),s},{parse:u,stringify:i}=JSON,f={json:!0,lossy:!0};var l=Object.freeze({__proto__:null,parse:e=>t(u(e)),stringify:e=>i(c(e,f))}),g=e=>({value:new Promise((t=>{let n=new Worker("data:application/javascript,"+encodeURIComponent('onmessage=({data:b})=>(Atomics.wait(b,0),postMessage("ok"))'));n.onmessage=t,n.postMessage(e)}))})
/*! (c) Andrea Giammarchi - ISC */;const w="65762173-c0e8-432d-8ea3-592c8d3140f4",{Int32Array:p,Map:h,SharedArrayBuffer:d,Uint16Array:y}=globalThis,{BYTES_PER_ELEMENT:b}=p,{BYTES_PER_ELEMENT:S}=y,{isArray:m}=Array,{notify:E,wait:A,waitAsync:M}=Atomics,{fromCharCode:O}=String,j=(e,t)=>e?(M||g)(t,0):(A(t,0),{value:{then:e=>e()}}),k=new WeakSet,v=new WeakMap;let B=0;const _=(e,{parse:t,stringify:n}=JSON)=>{if(!v.has(e)){const s=(t,...n)=>e.postMessage({[w]:n},{transfer:t});v.set(e,new Proxy(new h,{get:(n,r)=>"then"===r?null:(...n)=>{const a=B++;let o=new d(b);const c=new p(o);let u=[];k.has(n.at(-1)||u)&&k.delete(u=n.pop()),s(u,a,o,r,n);const i=e instanceof Worker;return j(i,c).value.then((()=>{const e=c[0],n=S*e;return o=new d(n+n%b),s([],a,o),j(i,new p(o)).value.then((()=>t(O(...new y(o).slice(0,e)))))}))},set(t,s,r){if(!t.size){const s=new h;e.addEventListener("message",(async({data:e})=>{const r=e?.[w];if(m(r)){const[e,a,...o]=r,c=new p(a);if(o.length){const[r,a]=o;if(!t.has(r))throw new Error(`Unsupported action: ${r}`);{const o=n(await t.get(r)(...a));s.set(e,o),c[0]=o.length}}else{const t=s.get(e);s.delete(e);for(let e=new y(a),n=0;n<t.length;n++)e[n]=t.charCodeAt(n)}E(c,0)}}))}return!!t.set(s,r)}}))}return v.get(e)},I=e=>_(e,l);I.transfer=_.transfer=(...e)=>(k.add(e),e);export{I as default};
