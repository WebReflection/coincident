/*! (c) Andrea Giammarchi - ISC */
const e="cac1bd70-1a6f-4486-b3ea-53a0558e836c",{Atomics:t,Int32Array:n,Map:r,SharedArrayBuffer:a,Uint16Array:s}=globalThis,{BYTES_PER_ELEMENT:o}=n,{BYTES_PER_ELEMENT:c}=s,{isArray:i}=Array,{notify:f,wait:l}=t,{fromCharCode:w}=String,d=new WeakSet,g=new WeakMap;let h=0;const E=(t,{parse:E,stringify:p}=JSON)=>{if(!g.has(t)){const y=(n,...r)=>t.postMessage({[e]:r},{transfer:n});g.set(t,new Proxy(new r,{get:(e,t)=>"then"===t?null:(...e)=>{const r=h++;let i=new a(o),f=new n(i),g=[];d.has(e.at(-1)||g)&&d.delete(g=e.pop()),y(g,r,i,t,e),l(f,0);const p=f[0],u=c*p;i=new a(u+u%o),f=new n(i),y([],r,i),l(f,0);let A="";for(let e=new s(i),t=0;t<p;t++)A+=w(e[t]);return E(A)},set(a,o,c){if(!a.size){const o=new r;t.addEventListener("message",(async({data:t})=>{const r=t?.[e];if(i(r)){const[e,t,...c]=r,i=new n(t);if(c.length){const[t,n]=c;if(!a.has(t))throw new Error(`Unsupported action: ${t}`);{const r=p(await a.get(t)(...n));o.set(e,r),i[0]=r.length}}else{const n=o.get(e);o.delete(e);for(let e=new s(t),r=0;r<n.length;r++)e[r]=n.charCodeAt(r)}f(i,0)}}))}return!!a.set(o,c)}}))}return g.get(t)};E.transfer=(...e)=>(d.add(e),e);export{E as default};
