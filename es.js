/*! (c) Andrea Giammarchi - ISC */
const e="bd97610f-e514-4409-911c-e35696a48c95",{Atomics:t,Int32Array:n,Map:r,SharedArrayBuffer:s,Uint16Array:a}=globalThis,{BYTES_PER_ELEMENT:o}=n,{BYTES_PER_ELEMENT:i}=a,{load:c,notify:f,store:w,wait:l}=t,{isArray:d}=Array,{fromCharCode:g}=String,E=new WeakSet,h=new WeakMap;let p=0;const y=(t,{parse:y,stringify:A}=JSON)=>{if(!h.has(t)){const u=(n,...r)=>t.postMessage({[e]:r},{transfer:n});h.set(t,new Proxy(new r,{get:(e,t)=>(...e)=>{const r=p++;let f=new s(o),w=new n(f),d=[];E.has(e.at(-1)||d)&&E.delete(d=e.pop()),u(d,r,f,t,e),l(w,0);const h=c(w,0),A=i*h;f=new s(A+A%o),w=new n(f),u([],r,f),l(w,0);let S="";for(let e=new a(f),t=0;t<h;t++)S+=g(c(e,t));return y(S)},set(s,o,i){if(!s.size){const o=new r;t.addEventListener("message",(async({data:t})=>{const r=t?.[e];if(d(r)){const[e,t,...i]=r,c=new n(t);if(i.length){const[t,n]=i;if(!s.has(t))throw new Error(`Unsupported action: ${t}`);{const r=A(await s.get(t)(...n));o.set(e,r),w(c,0,r.length)}}else{const n=o.get(e);o.delete(e);for(let e=new a(t),r=0;r<n.length;r++)e[r]=n.charCodeAt(r)}f(c,0)}}))}return!!s.set(o,i)}}))}return h.get(t)};y.transfer=(...e)=>(E.add(e),e);export{y as default};
