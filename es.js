/*! (c) Andrea Giammarchi - ISC */
const e="fe71b755-1439-415f-bb3d-cd0fd3cce5d5",{Atomics:t,Int32Array:n,Map:r,SharedArrayBuffer:s,Uint16Array:a}=globalThis,{BYTES_PER_ELEMENT:o}=n,{BYTES_PER_ELEMENT:c}=a,{from:i,isArray:f}=Array,{notify:d,wait:l}=t,{fromCharCode:w}=String,g=new WeakSet,h=new WeakMap;let E=0;const p=(t,{parse:i,stringify:p}=JSON)=>{if(!h.has(t)){const y=(n,...r)=>t.postMessage({[e]:r},{transfer:n});h.set(t,new Proxy(new r,{get:(e,t)=>"then"===t?null:(...e)=>{const r=E++;let f=new s(o);const d=new n(f);let h=[];g.has(e.at(-1)||h)&&g.delete(h=e.pop()),y(h,r,f,t,e),l(d,0);const p=d[0],u=c*p;return f=new s(u+u%o),y([],r,f),l(new n(f),0),i(w(...new a(f).slice(0,p)))},set(s,o,c){if(!s.size){const o=new r;t.addEventListener("message",(async({data:t})=>{const r=t?.[e];if(f(r)){const[e,t,...c]=r,i=new n(t);if(c.length){const[t,n]=c;if(!s.has(t))throw new Error(`Unsupported action: ${t}`);{const r=p(await s.get(t)(...n));o.set(e,r),i[0]=r.length}}else{const n=o.get(e);o.delete(e);for(let e=new a(t),r=0;r<n.length;r++)e[r]=n.charCodeAt(r)}d(i,0)}}))}return!!s.set(o,c)}}))}return h.get(t)};p.transfer=(...e)=>(g.add(e),e);export{p as default};
