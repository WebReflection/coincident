/*! (c) Andrea Giammarchi - ISC */
const e="8c3e4839-d260-4083-bf73-e4daee7f60d5",{Atomics:t,Error:n,Int32Array:a,JSON:r,Map:s,Proxy:o,SharedArrayBuffer:i,String:d,Uint16Array:f,WeakMap:w}=globalThis,{BYTES_PER_ELEMENT:c}=a,{BYTES_PER_ELEMENT:l}=f,{fromCharCode:g}=d,E=new w;let h=0;var y=(d,{parse:w,stringify:y}=r)=>{if(!E.has(d)){const r=(t,n,a,r)=>d.postMessage({[e]:{id:t,sb:n,action:a,args:r}});E.set(d,new o(new s,{get:(e,n)=>(...e)=>{const s=h++;let o=new i(c),d=new a(o);r(s,o,n,e),t.wait(d,0);const E=t.load(d,0),y=l*E;o=new i(y+y%c),d=new a(o),r(s,o),t.wait(d,0);let p="";for(let e=new f(o),n=0;n<E;n++)p+=g(t.load(e,n));return w(p)},set(r,o,i){if(!r.size){const o=new s;d.addEventListener("message",(async({data:s})=>{if(s?.[e]){const{action:i,args:d,id:w,sb:c}=s[e],l=new a(c);if(i){if(!r.has(i))throw new n(`Unsupported action: ${i}`);{const e=y(await r.get(i)(...d));o.set(w,e),t.store(l,0,e.length),t.notify(l,0)}}else{const e=o.get(w);o.delete(w);for(let t=new f(c),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);t.notify(l,0)}}}))}return!!r.set(o,i)}}))}return E.get(d)};export{y as default};
