/*! (c) Andrea Giammarchi - ISC */
const e="a6752de4-137c-4476-9bf6-53391389a8ac",{Atomics:t,Int32Array:n,Map:r,SharedArrayBuffer:a,Uint16Array:s}=globalThis,{BYTES_PER_ELEMENT:o}=n,{BYTES_PER_ELEMENT:i}=s,{load:c,notify:l,store:f,wait:w}=t,{isArray:d}=Array,{fromCharCode:g}=String,h=new WeakSet,E=new WeakMap;let p=0;const y=(t,{parse:y,stringify:u}=JSON)=>{if(!E.has(t)){const A=(n,...r)=>t.postMessage({[e]:r},{transfer:n});E.set(t,new Proxy(new r,{get:(e,t)=>"then"===t?null:(...e)=>{const r=p++;let l=new a(o),f=new n(l),d=[];h.has(e.at(-1)||d)&&h.delete(d=e.pop()),A(d,r,l,t,e),w(f,0);const E=c(f,0),u=i*E;l=new a(u+u%o),f=new n(l),A([],r,l),w(f,0);let S="";for(let e=new s(l),t=0;t<E;t++)S+=g(c(e,t));return y(S)},set(a,o,i){if(!a.size){const o=new r;t.addEventListener("message",(async({data:t})=>{const r=t?.[e];if(d(r)){const[e,t,...i]=r,c=new n(t);if(i.length){const[t,n]=i;if(!a.has(t))throw new Error(`Unsupported action: ${t}`);{const r=u(await a.get(t)(...n));o.set(e,r),f(c,0,r.length)}}else{const n=o.get(e);o.delete(e);for(let e=new s(t),r=0;r<n.length;r++)e[r]=n.charCodeAt(r)}l(c,0)}}))}return!!a.set(o,i)}}))}return E.get(t)};y.transfer=(...e)=>(h.add(e),e);export{y as default};
