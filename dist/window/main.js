let e=0;const t=e++,r=e++,s=e++,n=e++,a=e++,o=e++,i=e++,c=e++,l=e++,u=e++,f=e++,p=e++,g=e++,h=e++,d=e++;e++;const y=e++,b=e++;const m=globalThis.ImageData||class{},w=new Map(Reflect.ownKeys(Symbol).map(e=>[Symbol[e],`@${String(e)}`])),v=e=>{switch(e[0]){case"@":return Symbol[e.slice(1)];case"#":return Symbol.for(e.slice(1));case"!":return Symbol(e.slice(1));default:return Symbol()}},k=e=>w.get(e)||((e,t)=>void 0===t?"?":void 0===Symbol.keyFor(e)?`!${t}`:`#${t}`)(e,e.description),T=Object.assign,M=Array.from,S=Array.isArray,E=ArrayBuffer.isView,x=(e,t)=>[e,t],A=e=>e,O={},R=e=>(t,r=new Map)=>{for(let s=0,n=t.length;s<n;s++)t[s]=e(t[s],r);return t},P=([e,t])=>0===e?t:v(t),L=e=>"string"==typeof e?x(0,e):x(16,k(e)),{getPrototypeOf:$}=Object,{construct:B}=Reflect,{toStringTag:U}=Symbol,{toString:j}=O,W=(e,t=e[U])=>t in globalThis?t:W(B($(e.constructor),[0])),N=(e,t)=>[t?e:M(new Uint8Array(e)),e.resizable?e.maxByteLength:0],_=/\[('|")?(.+?)\1\]/g,D=(e,t)=>e?.[t];var I=(e,t)=>t.replace(_,".$2").split(".").reduce(D,e),z=(e,...t)=>t.map(F,e);function F(e){return"string"==typeof e?I(this,e):this[e]}const q=globalThis.Node||class{},{apply:C,construct:J,defineProperty:K,deleteProperty:H,get:V,getOwnPropertyDescriptor:Y,getPrototypeOf:X,has:G,isExtensible:Q,ownKeys:Z,set:ee,setPrototypeOf:te}=Reflect;var re=({reflect:e=A,transform:w=A,remote:M=A,module:$=e=>import(e),buffer:B=!1,timeout:U=-1}=O)=>{const j=(t,r=new Map)=>{if(!S(t))return t;const[s,n]=t;switch(s){case 2:{if(null===n)return globalThis;let e=r.get(t);if(!e){e=n,r.set(t,n);for(const e in n)n[e]=j(n[e],r)}return e}case 4:return r.get(t)||(r.set(t,n),D(n,r));case 8:{let t=le.get(n),r=t?.deref();return r||(t&&fe.unregister(t),r=function(...t){M.apply(this,t);for(let e=0,r=t.length;e<r;e++)t[e]=_(t[e]);return e(o,n,_(this),t).then(j)},t=new WeakRef(r),le.set(n,t),fe.register(r,n,t)),r}case 16:return v(n);default:return 1&s?ae(n):n}},_=e=>{switch(typeof e){case"object":{if(null===e)break;if(e===globalThis)return ue;const t=w(e);return ge&&pe.has(t)||t instanceof m?x(0,t):E(t)?x(68,((e,t)=>{const{BYTES_PER_ELEMENT:r,byteOffset:s,buffer:n,length:a}=e;return[W(e),N(n,t),s,a!==(n.byteLength-s)/r?a:0]})(t,B)):t instanceof ArrayBuffer?x(64,N(t,B)):x(S(t)?5:3,ne(t))}case"function":return x(9,ne(w(e)));case"symbol":return x(16,k(e));case"bigint":return x(32,e.toString())}return e},D=R(j),F=R(P),re=R(L),{clear:se,id:ne,ref:ae,unref:oe}=((e=0,t=new Map,r=new Map)=>({clear:()=>{t.clear(),r.clear()},id:s=>{let n=r.get(s);if(void 0===n){for(;t.has(n=e++););t.set(n,s),r.set(s,n)}return n},ref:e=>t.get(e),unref:e=>(r.delete(t.get(e)),t.delete(e))}))(),ie=/^(?:[0-9]+|length)$/,ce=-1<U,le=new Map,ue=x(2,null),fe=new FinalizationRegistry(r=>{le.delete(r),e(t,r)});let pe,ge=!1;return{assign:T,gather:z,query:I,direct:e=>(ge||(ge=!0,pe=new WeakSet),pe.add(e),e),evaluate:(e,...t)=>C(e,null,t),reflect(e,m,...w){const v=null===m,k=v?globalThis:ae(m);switch(e){case u:{const e=P(w[0]),t=v&&"import"===e,r=t?$:V(k,e),s=_(r);if(!ce)return s;let n,a=t,o=k;if(!t&&!(o instanceof q||S(o)&&"string"==typeof e&&ie.test(e)))if(e in k){for(;!(n=Y(o,e))&&(o=X(o),o););a=!!n&&"value"in n}else a=!0;return[a,s]}case o:{const e=new Map;return _(C(k,j(w[0],e),D(w[1],e)))}case y:return ee(k,P(w[0]),j(w[1]));case g:return G(k,P(w[0]));case d:return re(Z(k),le);case i:return _(J(k,D(w[0])));case f:{const e=Y(k,P(w[0]));if(e)for(const t in e)e[t]=_(e[t]);return e}case c:return K(k,P(w[0]),j(w[1]));case l:return H(k,P(w[0]));case p:return _(X(k));case b:return te(k,j(w[0]));case r:return void T(k,j(w[0]));case s:{const e=j(w[0]),t=Function(`return(${e}).apply(null,arguments)`);return _(C(t,null,D(w[1])))}case n:for(let e,t=0,r=(w=F(w[0],le)).length;t<r;t++)e=w[t],w[t]=_("string"==typeof e?I(k,e):k[e]);return w;case a:return _(I(k,w[0]));case t:return oe(m);case h:return Q(k)}},terminate(){for(const e of le.values())fe.unregister(e);le.clear(),se()}}};const{addEventListener:se}=EventTarget.prototype,ne=new WeakMap;Reflect.defineProperty(EventTarget.prototype,"addEventListener",{value(e,t,r){const s=r?.invoke;if(s){let t=ne.get(this);t||ne.set(this,t=new Map),t.set(e,[].concat(s)),delete r.invoke}return se.apply(this,arguments)}});let ae=0;const oe=ae++,ie=ae++,ce=ae++,le=ae++,ue=ae++,fe=ae++,pe=ae++,ge=ae++,he=ae++,de=ae++,ye=ae++,be=ae++,me=ae++,we=ae++,ve=ae++,ke=ae++,Te=ae++,Me=ae++,Se=ae++,Ee=ae++,xe=ae++,Ae=ae++,Oe=ae++,Re=ae++,Pe=ae++,Le=ae++;class $e{static push(e,t){e.sync(!1),e._(t,t.length)}constructor(e,t){const r=[];this.l=0,this.o=r,this.v=new Uint8Array(e,t),this.push=r.push.bind(r)}get length(){return this.l+this.o.length}sync(e){const t=this.o,r=t.length;r&&this._(e?t:t.splice(0),r)}_(e,t){const{buffer:r,byteOffset:s}=this.v,n=this.l;this.l+=t,t+=s+n,r.byteLength<t&&r.grow(t),this.v.set(e,n)}}new TextDecoder;const Be=new TextEncoder,Ue=new ArrayBuffer(8),je=new DataView(Ue),We=new Uint8Array(Ue),{isNaN:Ne,isFinite:_e,isInteger:De}=Number,{ownKeys:Ie}=Reflect,{is:ze}=Object,Fe=(e,t,r)=>{const s=r.get(e),n=!s;return n?(je.setUint32(0,t.length,!0),r.set(e,[We[0],We[1],We[2],We[3]])):t.push(Le,s[0],s[1],s[2],s[3]),n},qe=(e,t,r)=>{je.setUint32(0,r,!0),e.push(t,We[0],We[1],We[2],We[3])},Ce=(e,t,r)=>{switch(typeof e){case"number":e&&_e(e)?De(e)&&e<256&&-1<e?t.push(fe,e):(je.setFloat64(0,e,!0),t.push(ue,We[0],We[1],We[2],We[3],We[4],We[5],We[6],We[7])):Ne(e)?t.push(pe):e?t.push(e<0?he:ge):t.push(ze(e,0)?de:ye);break;case"object":switch(!0){case null===e:t.push(le);break;case!Fe(e,t,r):break;case S(e):{const s=e.length;qe(t,ke,s);for(let n=0;n<s;n++)Ce(e[n],t,r);break}case E(e):if(t.push(Re),Ce(W(e),t,r),e=e.buffer,!Fe(e,t,r))break;case e instanceof ArrayBuffer:{const r=new Uint8Array(e);qe(t,Te,r.length),Je(t,r);break}case e instanceof Date:t.push(Me),Ce(e.getTime(),t,r);break;case e instanceof Map:qe(t,Ee,e.size);for(const[s,n]of e)Ce(s,t,r),Ce(n,t,r);break;case e instanceof Set:qe(t,Oe,e.size);for(const s of e)Ce(s,t,r);break;case e instanceof Error:t.push(Se),Ce(e.name,t,r),Ce(e.message,t,r),Ce(e.stack,t,r);break;case e instanceof m:t.push(Pe),Ce(e.data,t,r),Ce(e.width,t,r),Ce(e.height,t,r),Ce(e.colorSpace,t,r),Ce(e.pixelFormat,t,r);break;case e instanceof RegExp:t.push(Ae),Ce(e.source,t,r),Ce(e.flags,t,r);break;default:if("toJSON"in e){const s=e.toJSON();Ce(s===e?null:s,t,r)}else{const s=Ie(e),n=s.length;qe(t,xe,n);for(let a=0;a<n;a++){const n=s[a];Ce(n,t,r),Ce(e[n],t,r)}}}break;case"string":if(Fe(e,t,r)){const r=Be.encode(e);qe(t,we,r.length),Je(t,r)}break;case"boolean":t.push(e?ie:oe);break;case"symbol":t.push(ve),Ce(k(e),t,r);break;case"bigint":{let r=be;9223372036854775807n<e?(je.setBigUint64(0,e,!0),r=me):je.setBigInt64(0,e,!0),t.push(r,We[0],We[1],We[2],We[3],We[4],We[5],We[6],We[7]);break}default:t.push(ce)}};let Je=(e,t)=>{for(let r=e.push,s=0,n=t.length;s<n;s+=32767)r.apply(e,t.subarray(s,s+32767))};const Ke=({byteOffset:e=0,Array:t=$e}={})=>(r,s)=>{const n=new t(s,e);Je=t.push,Ce(r,n,new Map);const a=n.length;return n.sync(!0),a},He="72ba9dfa",Ve="="+He,Ye="-"+He;var Xe=Promise.withResolvers.bind(Promise),Ge=(e=e=>e)=>{const t=new Map;let r=0;return[()=>{let s;do{s=e(r++)}while(t.has(s));const n=Xe();return t.set(s,n),[s,n.promise]},(e,r,s)=>{const n=t.get(e);t.delete(e),s?n?.reject(s):n?.resolve(r)}]};const Qe=[],Ze=new WeakSet,et=(...e)=>(Ze.add(e),e);let{SharedArrayBuffer:tt}=globalThis,rt=!0;try{new tt(4,{maxByteLength:8})}catch(e){rt=!1,tt=class extends ArrayBuffer{get growable(){return super.resizable}grow(e){super.resize(e)}}}const{assign:st,create:nt}=Object,at=`coincident-${rt?crypto.randomUUID():Math.random().toString(36).substring(2)}`,ot={byteOffset:2*Int32Array.BYTES_PER_ELEMENT},it=(e,t,r)=>{const s="then"!==t;return s&&(e[t]=r),s},ct=e=>{e.stopImmediatePropagation(),e.preventDefault()},lt=(e,t=-1)=>e?.reflected_ffi_timeout??t,{defineProperty:ut}=Object,[ft,pt]=Ge();let[gt,ht]=ft(),dt=()=>ht,{Atomics:yt,MessageChannel:bt,Worker:mt}=globalThis;if(rt)pt(gt);else{const e=new Map,t=(e,...t)=>{e.addEventListener(...t)};if("importScripts"in globalThis){t(globalThis,"message",e=>{ct(e),pt(gt,e.data)},{once:!0});const{wait:r}=yt,{parse:s}=JSON,n=t=>{const r=new XMLHttpRequest;try{if(r.timeout=3e3,r.open("POST",`${i}?sabayon`,!1),r.setRequestHeader("Content-Type","application/json"),r.send(`["${o}",${e.get(t)}]`),200===r.status)return r;throw r}catch{return r.abort(),n(t)}},a=(e,t)=>(e.set(s(t.responseText)),"ok");let o,i;yt={wait:(t,...s)=>e.has(t)?a(t,n(t)):r(t,...s)},ht=ht.then(e=>{[o,i]=e})}else{const r=[at,Math.random()].join("-").replace(/\W/g,"-"),s=new BroadcastChannel("dc78209b-186c-4f83-80e9-406becb7d9f3");s.onmessage=async t=>{const[n,a,o]=t.data;if(a===r)for(const[t,[r,a]]of e)if(r===o){await a.promise;let e=t.length;for(;e--&&!t[e];);s.postMessage([n,t.slice(0,e+1)]);break}};const n=t=>{const[r,s,n]=t.data;e.set(s,[r,Xe()]),ut(t,"data",{value:n})};bt=class extends bt{constructor(){super(),t(this.port1,"message",n)}},mt=class extends mt{constructor(e,t){super(e,t),super.postMessage([r,o])}};const{notify:a}=yt;yt={notify(t,...r){const s=e.get(t);return s?(s[1].resolve(),0):a(t,...r)}};let o="",i=null;const c=(e,r)=>{let s,n=!0;e.getRegistration(o).then(t=>t??e.register(o,r)).then(function r(a){const{controller:i}=e;if(n=n&&!!i,s=a.installing||a.waiting||a.active,"activated"===s.state){if(n){if(i.scriptURL===o)return pt(gt);a.unregister()}location.reload()}else t(s,"statechange",()=>r(a),{once:!0})})};dt=(e,t)=>{if(!i){const r=new URL(e,location.href);o=`${r.protocol}//${r.host}${r.pathname}`,c(navigator.serviceWorker,t),i=ht}return i}}}const wt="InstallTrigger"in globalThis?at:"",vt=e=>e,kt=e=>e===Ve?"main":e===Ye?"worker":e;class Tt extends Event{#e;constructor(e){super("message"),this.#e=e}get data(){return this.#e}}var Mt=e=>{const t=e?.transform,r=lt(e),s=(e?.encoder||Ke)(ot),n=!1!==e?.transfer;return{Worker:class extends mt{constructor(e,a){const o=rt?"":a?.serviceWorker||"",{notify:i}=o?yt:Atomics,{port1:c,port2:l}=new(o?bt:MessageChannel),[u,f]=Ge(vt),p=new Map,g=nt(null);o&&dt(o);let h="";super(e,st({type:"module"},a)),this.proxy=new Proxy(g,{get:(e,r)=>{if("then"===r)return;let s=p.get(r);return s||p.set(r,s=(...e)=>{const s=((e,t)=>{let r=Qe;return e&&Ze.has(t.at(-1)||Qe)&&(r=t.pop(),Ze.delete(r)),r})(n,e),[a,o]=u();return c.postMessage([a,r,t?e.map(t):e],s),((e,t)=>{if(h){const r=setTimeout(console.warn,3e3,`ðŸ’€ðŸ”’ - is proxy.${kt(h)}() awaiting proxy.${kt(t)}() ?`);e=e.then(e=>(clearTimeout(r),e),e=>(clearTimeout(r),Promise.reject(e)))}return e})(o,r)}),s},set:it}),wt&&(rt||o)&&super.addEventListener("message",e=>{const{data:t}=e;t?.ID===wt&&(ct(e),c.dispatchEvent(new Tt(t.data)))}),super.postMessage([wt,o,lt(a,r)],[l]),c.addEventListener("message",async({data:e})=>{const r=e[0],n=typeof r;if("number"===n)f.apply(null,e);else if(h=e[1],await(async(e,t,r)=>{try{const s=await t[e[1]].apply(null,e[2]);e[1]=r?r(s):s,e[2]=null}catch(t){e[2]=t}})(e,g,t),h="","string"===n)c.postMessage(e);else{const t=e[2]||e[1];r[1]=void 0===t?0:s(t,r.buffer),r[0]=1,i(r,0)}}),c.start()}},native:rt,transfer:et}},St=e=>{const t=e?.import,r=lt(e),s=Mt({...e,encoder:e?.encoder||Ke});class n extends s.Worker{#t;constructor(e,s){const{proxy:n}=super(e,s),a=re({...s,buffer:!0,reflect:n[Ye],timeout:lt(s,r),remote(e){e instanceof Event&&(e=>{const{currentTarget:t,target:r,type:s}=e,n=ne.get(t||r)?.get(s);if(n)for(const t of n)e[t]()})(e)},module:s?.import||t||(e=>import(new URL(e,location).href))});this.#t=a.terminate,this.ffi={assign:a.assign,direct:a.direct,evaluate:a.evaluate,gather:a.gather,query:a.query},n[Ve]=a.reflect}terminate(){this.#t(),super.terminate()}}return{...s,Worker:n}};export{St as default};
