const e="ownKeys",t="destruct",r="d50fd853-d4a3-4848-bba4-20c807102024",n="="+r,s="-"+r,{ArrayBuffer:o,Atomics:a,Promise:c}=globalThis,{isArray:i}=Array,{create:l,getPrototypeOf:u,values:f}=Object,p=u(Int32Array),g=l(a),d=()=>c.withResolvers();let y=0;const h=new Map,w=(e,t)=>class extends e{constructor(e,...r){super(e,...r),e instanceof t&&h.set(this,[y++,0,d()])}},m=new WeakSet,v=e=>(m.add(e),e),b=(e,t)=>{const{data:r}=e,n=i(r)&&(r.at(0)===t||0===r.at(1)&&!t);return n&&(e.stopImmediatePropagation(),e.preventDefault()),n},M=e=>null!==e&&"object"==typeof e&&!m.has(e),k=new WeakMap,E=(e,t,r)=>{if(h.has(e))t.set(e,h.get(e)[0]);else if(!(e instanceof p||e instanceof o))for(const n of f(e))M(n)&&!r.has(n)&&(r.add(n),E(n,t,r))},A=(...e)=>({value:new c((t=>{let r=new Worker("data:application/javascript,onmessage%3De%3D%3EpostMessage(!Atomics.wait(...e.data))");r.onmessage=()=>t("ok"),r.postMessage(e)}))}),T=(e,t,r)=>{for(const[r,n]of t)k.set(r,[n,e.currentTarget]);(({currentTarget:e,type:t,origin:r,lastEventId:n,source:s,ports:o},a)=>{e.dispatchEvent(new MessageEvent(t,{data:a,origin:r,lastEventId:n,source:s,ports:o}))})(e,r)};let{BigInt64Array:x,Int32Array:W,SharedArrayBuffer:S,Worker:R}=globalThis,P=e=>e,U=!1;const I=e=>({...e,type:"module"});try{new S(4),R=class extends R{constructor(e,t){super(e,I(t))}},g.waitAsync||(g.waitAsync=A)}catch(e){const t=crypto.randomUUID(),r=new Map,n=(e,t,r,...n)=>{e.addEventListener(t,r,...n)},s=({serviceWorker:e},s,o)=>{let a,c=!0;n(e,"message",(e=>{if(b(e,t)){const[n,s,o]=e.data,c=[s,o].join(","),i=e=>{r.delete(c),a.postMessage([t,s,o,e])},l=r.get(c);if(l)i(l);else{const{promise:e,resolve:t}=d();r.set(c,t),e.then(i)}}})),e.getRegistration(s).then((t=>t??e.register(s))).then((function t(r){c=c&&!!e.controller,a=r.installing||r.waiting||r.active,"activated"===a.state?c?o():location.reload():n(a,"statechange",(()=>t(r)),{once:!0})}))};P=v,U=!0,g.notify=(e,n)=>{const[s,o]=(e=>k.get(e))(e),a=[s,n].join(","),c=r.get(a);return c?c(e):r.set(a,e),o.postMessage([t,1,e,s,n]),0},g.waitAsync=(e,...t)=>{const[r,n]=((e,t)=>{const r=h.get(e),[n,s,{promise:o}]=r;return r[1]=t,[n,o]})(e,...t);return{value:n}},S=class extends o{},x=w(x,S),W=w(W,S);let a=null;R=class extends R{constructor(e,r){let o=r?.serviceWorker||"";if(o){if(o=new URL(o,location.href).href,r={...r,serviceWorker:o},!a){const{promise:e,resolve:t}=d();s(navigator,o,t),a=e}a.then((()=>super.postMessage([t,3])))}super(e,I(r)),super.postMessage([t,0,r]),n(this,"message",(e=>{if(b(e,t)){const[t,r,...n]=e.data;switch(r){case 1:((e,t,r)=>{for(const[n,[s,o,{resolve:a}]]of h)if(t===s&&r===o){for(let t=0;t<e.length;t++)n[t]=e[t];h.delete(n),a("ok");break}})(...n);break;case 2:T(e,...n)}}}))}postMessage(e,...r){return super.postMessage(((e,t)=>{const r=new Map;return M(t)&&E(t,r,new Set),r.size?[e,2,r,t]:t})(t,e),...r)}}}const{BYTES_PER_ELEMENT:j}=Int32Array,{BYTES_PER_ELEMENT:L}=Uint16Array,{notify:D}=g,O=new TextDecoder("utf-16"),B=new WeakSet,$=(...e)=>(B.add(e),e);let _="";let N=0;const z=([e,t,r,n,s,o,a,c,i],l)=>(...u)=>{let f=""!==_,p=0;f&&"="!==_[0]&&"-"!==_[0]&&(p=((e,t)=>setTimeout(console.warn,3e3,`ðŸ’€ðŸ”’ - proxy.${e}() in proxy.${t}()`))(l,_));const g=N++,d=[];B.has(u.at(-1)||d)&&B.delete(d=u.pop());const y=r(c?u.map(c):u);let h=t(2*j);return a([e,2,l,g,h,y,n],{transfer:d}),i(h,0).value.then((()=>{f&&clearTimeout(p);const r=h[1];if(!r)return;const n=L*r;return h=t(n+n%j),a([e,1,g,h]),i(h,0).value.then((()=>{const e=new Uint16Array(h.buffer),t=o?e.subarray(0,r):e.slice(0,r);return s(O.decode(t))}))}))};var F=({parse:e,stringify:t,transform:r}=JSON)=>{const n=((e,t)=>async(r,n,[s,o,a,c,i])=>{i&&(_=s);try{const s=await r(...c);if(void 0!==s){const r=e(t?t(s):s);n.set(o,r),a[1]=r.length}}finally{i&&(_=""),a[0]=1,D(a,0)}})(t,r),s=crypto.randomUUID();return{Worker:class extends R{constructor(t,o){const a=new Map,c=new Map;super(t,o),this.proxy=((e,t)=>new Proxy(t,{get:(t,r)=>{let n;return"then"!==r&&(n=t.get(r),n||(n=z(e,r),t.set(r,n))),n},set:(e,t,r)=>"then"!==t&&!!e.set(t,r)}))([s,e=>new W(new S(e)),P,!1,e,U,(...e)=>this.postMessage(...e),r,g.waitAsync],a),this.postMessage(P([s,0,o])),this.addEventListener("message",(e=>{if(b(e,s)){const[t,r,...s]=e.data;switch(r){case 2:((e,t,r,n)=>{const[s]=n,o=r.get(s);if(!o)throw new Error(`Unknown proxy.${s}()`);e(o,t,n)})(n,c,a,s);break;case 1:((e,[t,r])=>{const n=e.get(t);e.delete(t);for(let e=new Uint16Array(r.buffer),t=0,{length:s}=n;t<s;t++)e[t]=n.charCodeAt(t);D(r,0)})(c,s)}}}))}},polyfill:U,transfer:$}};const Y="array",C="function",J="null",K="number",q="object",G="string",H="symbol",Q="undefined";let V=0;const X=new Map,Z=new Map,ee=e=>Z.get(e),te=e=>{if(!X.has(e)){let t;for(;Z.has(t=V++););X.set(e,t),Z.set(t,e)}return X.get(e)};var re=Object.fromEntries([Y,"bigint","boolean",C,J,K,q,G,H,Q].map(((e,t)=>[e,t])));const{[e]:ne}=Reflect,se=new Map(ne(Symbol).filter((e=>typeof Symbol[e]===H)).map((e=>[Symbol[e],e]))),oe=e=>se.get(e)||`.${Symbol.keyFor(e)||""}`,ae=new FinalizationRegistry((([e,t,r])=>{r&&console.debug(`%c${String(t)}`,"font-weight:bold","collected"),e(t)})),ce=Object.create(null),{addEventListener:ie}=EventTarget.prototype,le=new WeakMap;Reflect.defineProperty(EventTarget.prototype,"addEventListener",{value(e,t,...r){const n=r.at(0)?.invoke;if(n){let t=le.get(this);t||(t=new Map,le.set(this,t)),t.set(e,[].concat(n)),delete r[0].invoke}return ie.call(this,e,t,...r)}});const{isArray:ue}=Array,fe=e=>{const t=typeof e;switch(t){case q:return null===e?[re[J],e]:e===globalThis?[re[q],null]:ue(e)?[re[Y],te(e)]:[re[q],e instanceof p?e:te(e)];case C:return[re[C],te(e)];case H:return[re[H],oe(e)];default:return[re[t],e]}};var pe=(r,n)=>{const s=new Map,o=e=>{s.delete(e),n(t,e)},a=([e,t])=>{switch(e){case re[q]:if(null===t)return globalThis;if(typeof t===K)return ee(t);if(!(t instanceof p))for(const e in t)t[e]=a(t[e]);return t;case re[Y]:return typeof t===K?ee(t):t.map(a);case re[C]:switch(typeof t){case K:return ee(t);case G:{let e=s.get(t)?.deref();return e||(e=((e,t,{debug:r,handler:n,return:s,token:o=e}=ce)=>{const a=s||new Proxy(e,n||ce),c=[a,[t,e,!!r]];return!1!==o&&c.push(o),ae.register(...c),a})(t,o,{token:!1,return:function(...e){return e.length&&e[0]instanceof Event&&(e=>{const{currentTarget:t,target:r,type:n}=e,s=le.get(t||r)?.get(n);if(s)for(const t of s)e[t]()})(e[0]),n("apply",t,fe(this),e.map(fe)).then(a)}}),s.set(t,new WeakRef(e))),e}}case re[H]:return(e=>{if(e.startsWith("."))return Symbol.for(e.slice(1));for(const[t,r]of se)if(r===e)return t})(t);default:return t}},c=e=>import(r(e));return(r,n,...s)=>{if(r===t)(e=>{const[t,r]=typeof e===K?[Z,X]:[X,Z],n=t.has(e);n&&(r.delete(t.get(e)),t.delete(e))})(n);else{const t=Reflect[r],o=null==n?globalThis:ee(n);switch(r){case"defineProperty":{const[e,r]=s.map(a);return fe(t(o,e,r))}case"getOwnPropertyDescriptor":{const e=t(o,...s.map(a));if(e){const{get:t,set:r,value:n}=e;t&&(e.get=fe(t)),r&&(e.set=fe(r)),n&&(e.value=fe(n))}return[re[e?q:Q],e]}case e:return[re[Y],t(o).map(fe)];case"get":if(null==n&&"import"===s[0][1])return fe(c);default:return((e,t,r)=>fe(e(t,...r.map(a))))(t,o,s)}}}},ge=e=>{const t=e?.import,r=F(e);class o extends r.Worker{constructor(e,r){const{proxy:o}=super(e,r);o[n]=pe(r?.import||t||(e=>new URL(e,location.href)),o[s])}}return{...r,Worker:o}};export{ge as default};
