let e=0;const t=e++,r=e++,s=e++,n=e++,a=e++,o=e++,i=e++,c=e++,l=e++,u=e++,f=e++,p=e++,h=e++,g=e++,y=e++;e++;const d=e++,b=e++;const m=globalThis.ImageData||class{},w=new Map(Reflect.ownKeys(Symbol).map(e=>[Symbol[e],`@${String(e)}`])),v=e=>{switch(e[0]){case"@":return Symbol[e.slice(1)];case"#":return Symbol.for(e.slice(1));case"!":return Symbol(e.slice(1));default:return Symbol()}},k=e=>w.get(e)||((e,t)=>void 0===t?"?":void 0===Symbol.keyFor(e)?`!${t}`:`#${t}`)(e,e.description),T=Object.assign,M=Array.from,S=Array.isArray,E=ArrayBuffer.isView,x=(e,t)=>[e,t],A=e=>e,O={},P=e=>(t,r=new Map)=>{for(let s=0,n=t.length;s<n;s++)t[s]=e(t[s],r);return t},R=([e,t])=>0===e?t:v(t),B=e=>"string"==typeof e?x(0,e):x(16,k(e)),{getPrototypeOf:L}=Object,{construct:U}=Reflect,{toStringTag:$}=Symbol,{toString:j}=O,W=(e,t=e[$])=>t in globalThis?t:W(U(L(e.constructor),[0])),N=(e,t)=>[t?e:M(new Uint8Array(e)),e.resizable?e.maxByteLength:0],_=/\[('|")?(.+?)\1\]/g,D=(e,t)=>e?.[t];var I=(e,t)=>t.replace(_,".$2").split(".").reduce(D,e),z=(e,...t)=>t.map(F,e);function F(e){return"string"==typeof e?I(this,e):this[e]}const q=globalThis.Node||class{},{apply:C,construct:J,defineProperty:K,deleteProperty:H,get:V,getOwnPropertyDescriptor:Y,getPrototypeOf:X,has:G,isExtensible:Q,ownKeys:Z,set:ee,setPrototypeOf:te}=Reflect;var re=({reflect:e=A,transform:w=A,remote:M=A,module:L=e=>import(e),buffer:U=!1,timeout:$=-1}=O)=>{const j=(t,r=new Map)=>{if(!S(t))return t;const[s,n]=t;switch(s){case 2:{if(null===n)return globalThis;let e=r.get(t);if(!e){e=n,r.set(t,n);for(const e in n)n[e]=j(n[e],r)}return e}case 4:return r.get(t)||(r.set(t,n),D(n,r));case 8:{let t=le.get(n),r=t?.deref();return r||(t&&fe.unregister(t),r=function(...t){M.apply(this,t);for(let e=0,r=t.length;e<r;e++)t[e]=_(t[e]);return e(o,n,_(this),t).then(j)},t=new WeakRef(r),le.set(n,t),fe.register(r,n,t)),r}case 16:return v(n);default:return 1&s?ae(n):n}},_=e=>{switch(typeof e){case"object":{if(null===e)break;if(e===globalThis)return ue;const t=w(e);return he&&pe.has(t)||t instanceof m?x(0,t):E(t)?x(68,((e,t)=>{const{BYTES_PER_ELEMENT:r,byteOffset:s,buffer:n,length:a}=e;return[W(e),N(n,t),s,a!==(n.byteLength-s)/r?a:0]})(t,U)):t instanceof ArrayBuffer?x(64,N(t,U)):x(S(t)?5:3,ne(t))}case"function":return x(9,ne(w(e)));case"symbol":return x(16,k(e));case"bigint":return x(32,e.toString())}return e},D=P(j),F=P(R),re=P(B),{clear:se,id:ne,ref:ae,unref:oe}=((e=0,t=new Map,r=new Map)=>({clear:()=>{t.clear(),r.clear()},id:s=>{let n=r.get(s);if(void 0===n){for(;t.has(n=e++););t.set(n,s),r.set(s,n)}return n},ref:e=>t.get(e),unref:e=>(r.delete(t.get(e)),t.delete(e))}))(),ie=/^(?:[0-9]+|length)$/,ce=-1<$,le=new Map,ue=x(2,null),fe=new FinalizationRegistry(r=>{le.delete(r),e(t,r)});let pe,he=!1;return{assign:T,gather:z,query:I,direct:e=>(he||(he=!0,pe=new WeakSet),pe.add(e),e),evaluate:(e,...t)=>C(e,null,t),reflect(e,m,...w){const v=null===m,k=v?globalThis:ae(m);switch(e){case u:{const e=R(w[0]),t=v&&"import"===e,r=t?L:V(k,e),s=_(r);if(!ce)return s;let n,a=t,o=k;if(!t&&!(o instanceof q||S(o)&&"string"==typeof e&&ie.test(e)))if(e in k){for(;!(n=Y(o,e))&&(o=X(o),o););a=!!n&&"value"in n}else a=!0;return[a,s]}case o:{const e=new Map;return _(C(k,j(w[0],e),D(w[1],e)))}case d:return ee(k,R(w[0]),j(w[1]));case h:return G(k,R(w[0]));case y:return re(Z(k),le);case i:return _(J(k,D(w[0])));case f:{const e=Y(k,R(w[0]));if(e)for(const t in e)e[t]=_(e[t]);return e}case c:return K(k,R(w[0]),j(w[1]));case l:return H(k,R(w[0]));case p:return _(X(k));case b:return te(k,j(w[0]));case r:return void T(k,j(w[0]));case s:{const e=j(w[0]),t=Function(`return(${e}).apply(null,arguments)`);return _(C(t,null,D(w[1])))}case n:for(let e,t=0,r=(w=F(w[0],le)).length;t<r;t++)e=w[t],w[t]=_("string"==typeof e?I(k,e):k[e]);return w;case a:return _(I(k,w[0]));case t:return oe(m);case g:return Q(k)}},terminate(){for(const e of le.values())fe.unregister(e);le.clear(),se()}}};const{addEventListener:se}=EventTarget.prototype,ne=new WeakMap;Reflect.defineProperty(EventTarget.prototype,"addEventListener",{value(e,t,r){const s=r?.invoke;if(s){let t=ne.get(this);t||ne.set(this,t=new Map),t.set(e,[].concat(s)),delete r.invoke}return se.apply(this,arguments)}});let ae=0;const oe=ae++,ie=ae++,ce=ae++,le=ae++,ue=ae++,fe=ae++,pe=ae++,he=ae++,ge=ae++,ye=ae++,de=ae++,be=ae++,me=ae++,we=ae++,ve=ae++,ke=ae++,Te=ae++,Me=ae++,Se=ae++,Ee=ae++,xe=ae++,Ae=ae++,Oe=ae++,Pe=ae++,Re=ae++,Be=ae++,Le=ae++,Ue=ae++;class $e{static push(e,t){e.sync(!1),e._(t,t.length)}constructor(e,t){const r=[];this.l=0,this.o=r,this.v=new Uint8Array(e,t),this.push=r.push.bind(r)}get length(){return this.l+this.o.length}sync(e){const t=this.o,r=t.length;r&&this._(e?t:t.splice(0),r)}_(e,t){const{buffer:r,byteOffset:s}=this.v,n=this.l;this.l+=t,t+=s+n,r.byteLength<t&&r.grow(t),this.v.set(e,n)}}new TextDecoder;const je=new TextEncoder,We=new ArrayBuffer(8),Ne=new DataView(We),_e=new Uint8Array(We),{isNaN:De,isFinite:Ie,isInteger:ze}=Number,{ownKeys:Fe}=Reflect,{is:qe}=Object,Ce=(e,t,r)=>{const s=r.get(e),n=!s;return n?(Ne.setUint32(0,t.length,!0),r.set(e,[_e[0],_e[1],_e[2],_e[3]])):t.push(Ue,s[0],s[1],s[2],s[3]),n},Je=(e,t,r)=>{Ne.setUint32(0,r,!0),e.push(t,_e[0],_e[1],_e[2],_e[3])},Ke=(e,t,r)=>{switch(typeof e){case"number":e&&Ie(e)?ze(e)&&e<256&&-1<e?t.push(fe,e):(Ne.setFloat64(0,e,!0),t.push(ue,_e[0],_e[1],_e[2],_e[3],_e[4],_e[5],_e[6],_e[7])):De(e)?t.push(pe):e?t.push(e<0?ge:he):t.push(qe(e,0)?ye:de);break;case"object":switch(!0){case null===e:t.push(le);break;case!Ce(e,t,r):break;case S(e):{const s=e.length;Je(t,ke,s);for(let n=0;n<s;n++)Ke(e[n],t,r);break}case E(e):if(t.push(Pe),Ke(W(e),t,r),e=e.buffer,!Ce(e,t,r))break;case e instanceof ArrayBuffer:{const r=new Uint8Array(e);Je(t,Te,r.length),Ve(t,r);break}case e instanceof Date:t.push(Me),Ke(e.getTime(),t,r);break;case e instanceof Map:Je(t,Ee,e.size);for(const[s,n]of e)Ke(s,t,r),Ke(n,t,r);break;case e instanceof Set:Je(t,Oe,e.size);for(const s of e)Ke(s,t,r);break;case e instanceof Error:t.push(Se),Ke(e.name,t,r),Ke(e.message,t,r),Ke(e.stack,t,r);break;case e instanceof m:t.push(Re),Ke(e.data,t,r),Ke(e.width,t,r),Ke(e.height,t,r),Ke(e.colorSpace,t,r),Ke(e.pixelFormat,t,r);break;case e instanceof RegExp:t.push(Ae),Ke(e.source,t,r),Ke(e.flags,t,r);break;case e instanceof File:t.push(Le),Ke(e.name,t,r),Ke(e.lastModified,t,r);case e instanceof Blob:{const s=e.size;t.push(Be),Ke(e.type,t,r),Ke(s,t,r);const n=t.length;Ve(t,new Uint8Array(s)),He.push(e.arrayBuffer().then(e=>[n,e]));break}default:if("toJSON"in e){const s=e.toJSON();Ke(s===e?null:s,t,r)}else{const s=Fe(e),n=s.length;Je(t,xe,n);for(let a=0;a<n;a++){const n=s[a];Ke(n,t,r),Ke(e[n],t,r)}}}break;case"string":if(Ce(e,t,r)){const r=je.encode(e);Je(t,we,r.length),Ve(t,r)}break;case"boolean":t.push(e?ie:oe);break;case"symbol":t.push(ve),Ke(k(e),t,r);break;case"bigint":{let r=be;9223372036854775807n<e?(Ne.setBigUint64(0,e,!0),r=me):Ne.setBigInt64(0,e,!0),t.push(r,_e[0],_e[1],_e[2],_e[3],_e[4],_e[5],_e[6],_e[7]);break}default:t.push(ce)}},He=[];let Ve=(e,t)=>{for(let r=e.push,s=0,n=t.length;s<n;s+=32767)r.apply(e,t.subarray(s,s+32767))};const Ye=({byteOffset:e=0,Array:t=$e}={})=>(r,s)=>{const n=new t(s,e);Ve=t.push,Ke(r,n,new Map);const a=n.length;return n.sync(!0),He.length?Promise.all(He.splice(0)).then(t=>{const r=new Uint8Array(s,e);for(const[e,s]of t)r.set(new Uint8Array(s),e);return a}):a},Xe="b3e5cb6e",Ge="="+Xe,Qe="-"+Xe;var Ze=Promise.withResolvers.bind(Promise),et=(e=e=>e)=>{const t=new Map;let r=0;return[()=>{let s;do{s=e(r++)}while(t.has(s));const n=Ze();return t.set(s,n),[s,n.promise]},(e,r,s)=>{const n=t.get(e);t.delete(e),s?n?.reject(s):n?.resolve(r)}]};const tt=[],rt=new WeakSet,st=(...e)=>(rt.add(e),e);let{SharedArrayBuffer:nt}=globalThis,at=!0;try{new nt(4,{maxByteLength:8})}catch(e){at=!1,nt=class extends ArrayBuffer{get growable(){return super.resizable}grow(e){super.resize(e)}}}const{assign:ot,create:it}=Object,ct=`coincident-${at?crypto.randomUUID():Math.random().toString(36).substring(2)}`,lt={byteOffset:2*Int32Array.BYTES_PER_ELEMENT},ut=(e,t,r)=>{const s="then"!==t;return s&&(e[t]=r),s},ft=e=>{e.stopImmediatePropagation(),e.preventDefault()},pt=(e,t=-1)=>e?.reflected_ffi_timeout??t,{defineProperty:ht}=Object,[gt,yt]=et();let[dt,bt]=gt(),mt=()=>bt,{Atomics:wt,MessageChannel:vt,Worker:kt}=globalThis;if(at)yt(dt);else{const e=new Map,t=(e,...t)=>{e.addEventListener(...t)};if("importScripts"in globalThis){t(globalThis,"message",e=>{ft(e),yt(dt,e.data)},{once:!0});const{wait:r}=wt,{parse:s}=JSON,n=t=>{const r=new XMLHttpRequest;try{if(r.timeout=3e3,r.open("POST",`${i}?sabayon`,!1),r.setRequestHeader("Content-Type","application/json"),r.send(`["${o}",${e.get(t)}]`),200===r.status)return r;throw r}catch{return r.abort(),n(t)}},a=(e,t)=>(e.set(s(t.responseText)),"ok");let o,i;wt={wait:(t,...s)=>e.has(t)?a(t,n(t)):r(t,...s)},bt=bt.then(e=>{[o,i]=e})}else{const r=[ct,Math.random()].join("-").replace(/\W/g,"-"),s=new BroadcastChannel("dc78209b-186c-4f83-80e9-406becb7d9f3");s.onmessage=async t=>{const[n,a,o]=t.data;if(a===r)for(const[t,[r,a]]of e)if(r===o){await a.promise;let e=t.length;for(;e--&&!t[e];);s.postMessage([n,t.slice(0,e+1)]);break}};const n=t=>{const[r,s,n]=t.data;e.set(s,[r,Ze()]),ht(t,"data",{value:n})};vt=class extends vt{constructor(){super(),t(this.port1,"message",n)}},kt=class extends kt{constructor(e,t){super(e,t),super.postMessage([r,o])}};const{notify:a}=wt;wt={notify(t,...r){const s=e.get(t);return s?(s[1].resolve(),0):a(t,...r)}};let o="",i=null;const c=(e,r)=>{let s,n=!0;e.getRegistration(o).then(t=>t??e.register(o,r)).then(function r(a){const{controller:i}=e;if(n=n&&!!i,s=a.installing||a.waiting||a.active,"activated"===s.state){if(n){if(i.scriptURL===o)return yt(dt);a.unregister()}location.reload()}else t(s,"statechange",()=>r(a),{once:!0})})};mt=(e,t)=>{if(!i){const r=new URL(e,location.href);o=`${r.protocol}//${r.host}${r.pathname}`,c(navigator.serviceWorker,t),i=bt}return i}}}const Tt="InstallTrigger"in globalThis?ct:"",Mt=e=>e,St=e=>e===Ge?"main":e===Qe?"worker":e;class Et extends Event{#e;constructor(e){super("message"),this.#e=e}get data(){return this.#e}}var xt=e=>{const t=e?.transform,r=pt(e),s=(e?.encoder||Ye)(lt),n=!1!==e?.transfer;return{Worker:class extends kt{constructor(e,a){const o=at?"":a?.serviceWorker||"",{notify:i}=o?wt:Atomics,{port1:c,port2:l}=new(o?vt:MessageChannel),[u,f]=et(Mt),p=new Map,h=it(null);o&&mt(o);let g="";super(e,ot({type:"module"},a)),this.proxy=new Proxy(h,{get:(e,r)=>{if("then"===r)return;let s=p.get(r);return s||p.set(r,s=(...e)=>{const s=((e,t)=>{let r=tt;return e&&rt.has(t.at(-1)||tt)&&(r=t.pop(),rt.delete(r)),r})(n,e),[a,o]=u();return c.postMessage([a,r,t?e.map(t):e],s),((e,t)=>{if(g){const r=setTimeout(console.warn,3e3,`💀🔒 - is proxy.${St(g)}() awaiting proxy.${St(t)}() ?`);e=e.then(e=>(clearTimeout(r),e),e=>(clearTimeout(r),Promise.reject(e)))}return e})(o,r)}),s},set:ut}),Tt&&(at||o)&&super.addEventListener("message",e=>{const{data:t}=e;t?.ID===Tt&&(ft(e),c.dispatchEvent(new Et(t.data)))}),super.postMessage([Tt,o,pt(a,r)],[l]),c.addEventListener("message",async({data:e})=>{const r=e[0],n=typeof r;if("number"===n)f.apply(null,e);else if(g=e[1],await(async(e,t,r)=>{try{const s=await t[e[1]].apply(null,e[2]);e[1]=r?r(s):s,e[2]=null}catch(t){e[2]=t}})(e,h,t),g="","string"===n)c.postMessage(e);else{const t=e[2]||e[1],n=void 0===t?0:s(t,r.buffer);r[1]="number"==typeof n?n:await n,r[0]=1,i(r,0)}}),c.start()}},native:at,transfer:st}},At=e=>{const t=e?.import,r=pt(e),s=xt({...e,encoder:e?.encoder||Ye});class n extends s.Worker{#t;constructor(e,s){const{proxy:n}=super(e,s),a=re({...s,buffer:!0,reflect:n[Qe],timeout:pt(s,r),remote(e){e instanceof Event&&(e=>{const{currentTarget:t,target:r,type:s}=e,n=ne.get(t||r)?.get(s);if(n)for(const t of n)e[t]()})(e)},module:s?.import||t||(e=>import(new URL(e,location).href))});this.#t=a.terminate,this.ffi={assign:a.assign,direct:a.direct,evaluate:a.evaluate,gather:a.gather,query:a.query},n[Ge]=a.reflect}terminate(){this.#t(),super.terminate()}}return{...s,Worker:n}};export{At as default};
