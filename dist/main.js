const e="b3e5cb6e",t="="+e,s="-"+e;var n=Promise.withResolvers.bind(Promise),r=(e=e=>e)=>{const t=new Map;let s=0;return[()=>{let r;do{r=e(s++)}while(t.has(r));const a=n();return t.set(r,a),[r,a.promise]},(e,s,n)=>{const r=t.get(e);t.delete(e),n?r?.reject(n):r?.resolve(s)}]};let a=0;const o=a++,c=a++,i=a++,l=a++,u=a++,h=a++,p=a++,f=a++,g=a++,b=a++,d=a++,y=a++,m=a++,w=a++,k=a++,v=a++,T=a++,M=a++,A=a++,S=a++,x=a++,E=a++,U=a++,B=a++,O=a++,$=a++,R=a++,P=a++;const j=globalThis.ImageData||class{};class L{static push(e,t){e.sync(!1),e._(t,t.length)}constructor(e,t){const s=[];this.l=0,this.o=s,this.v=new Uint8Array(e,t),this.push=s.push.bind(s)}get length(){return this.l+this.o.length}sync(e){const t=this.o,s=t.length;s&&this._(e?t:t.splice(0),s)}_(e,t){const{buffer:s,byteOffset:n}=this.v,r=this.l;this.l+=t,t+=n+r,s.byteLength<t&&s.grow(t),this.v.set(e,r)}}const I=new Map(Reflect.ownKeys(Symbol).map(e=>[Symbol[e],`@${String(e)}`])),D=e=>I.get(e)||((e,t)=>void 0===t?"?":void 0===Symbol.keyFor(e)?`!${t}`:`#${t}`)(e,e.description),N=Array.isArray,_=ArrayBuffer.isView;new TextDecoder;const W=new TextEncoder,z=new ArrayBuffer(8),F=new DataView(z),C=new Uint8Array(z),{getPrototypeOf:J}=Object,{construct:q}=Reflect,{toStringTag:H}=Symbol,K=(e,t=e[H])=>t in globalThis?t:K(q(J(e.constructor),[0])),{isNaN:V,isFinite:X,isInteger:Y}=Number,{ownKeys:G}=Reflect,{is:Q}=Object,Z=(e,t,s)=>{const n=s.get(e),r=!n;return r?(F.setUint32(0,t.length,!0),s.set(e,[C[0],C[1],C[2],C[3]])):t.push(P,n[0],n[1],n[2],n[3]),r},ee=(e,t,s)=>{F.setUint32(0,s,!0),e.push(t,C[0],C[1],C[2],C[3])},te=(e,t,s)=>{switch(typeof e){case"number":e&&X(e)?Y(e)&&e<256&&-1<e?t.push(h,e):(F.setFloat64(0,e,!0),t.push(u,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7])):V(e)?t.push(p):e?t.push(e<0?g:f):t.push(Q(e,0)?b:d);break;case"object":switch(!0){case null===e:t.push(l);break;case!Z(e,t,s):break;case N(e):{const n=e.length;ee(t,v,n);for(let r=0;r<n;r++)te(e[r],t,s);break}case _(e):if(t.push(B),te(K(e),t,s),e=e.buffer,!Z(e,t,s))break;case e instanceof ArrayBuffer:{const s=new Uint8Array(e);ee(t,T,s.length),ne(t,s);break}case e instanceof Date:t.push(M),te(e.getTime(),t,s);break;case e instanceof Map:ee(t,S,e.size);for(const[n,r]of e)te(n,t,s),te(r,t,s);break;case e instanceof Set:ee(t,U,e.size);for(const n of e)te(n,t,s);break;case e instanceof Error:t.push(A),te(e.name,t,s),te(e.message,t,s),te(e.stack,t,s);break;case e instanceof j:t.push(O),te(e.data,t,s),te(e.width,t,s),te(e.height,t,s),te(e.colorSpace,t,s),te(e.pixelFormat,t,s);break;case e instanceof RegExp:t.push(E),te(e.source,t,s),te(e.flags,t,s);break;case e instanceof File:t.push(R),te(e.name,t,s),te(e.lastModified,t,s);case e instanceof Blob:{const n=e.size;t.push($),te(e.type,t,s),te(n,t,s);const r=t.length;ne(t,new Uint8Array(n)),se.push(e.arrayBuffer().then(e=>[r,e]));break}default:if("toJSON"in e){const n=e.toJSON();te(n===e?null:n,t,s)}else{const n=G(e),r=n.length;ee(t,x,r);for(let a=0;a<r;a++){const r=n[a];te(r,t,s),te(e[r],t,s)}}}break;case"string":if(Z(e,t,s)){const s=W.encode(e);ee(t,w,s.length),ne(t,s)}break;case"boolean":t.push(e?c:o);break;case"symbol":t.push(k),te(D(e),t,s);break;case"bigint":{let s=y;9223372036854775807n<e?(F.setBigUint64(0,e,!0),s=m):F.setBigInt64(0,e,!0),t.push(s,C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7]);break}default:t.push(i)}},se=[];let ne=(e,t)=>{for(let s=e.push,n=0,r=t.length;n<r;n+=32767)s.apply(e,t.subarray(n,n+32767))};const re=({byteOffset:e=0,Array:t=L}={})=>(s,n)=>{const r=new t(n,e);ne=t.push,te(s,r,new Map);const a=r.length;return r.sync(!0),se.length?Promise.all(se.splice(0)).then(t=>{const s=new Uint8Array(n,e);for(const[e,n]of t)s.set(new Uint8Array(n),e);return a}):a},ae=[],oe=new WeakSet,ce=(...e)=>(oe.add(e),e);let{SharedArrayBuffer:ie}=globalThis,le=!0;try{new ie(4,{maxByteLength:8})}catch(e){le=!1,ie=class extends ArrayBuffer{get growable(){return super.resizable}grow(e){super.resize(e)}}}const{assign:ue,create:he}=Object,pe=`coincident-${le?crypto.randomUUID():Math.random().toString(36).substring(2)}`,fe={byteOffset:2*Int32Array.BYTES_PER_ELEMENT},ge=(e,t,s)=>{const n="then"!==t;return n&&(e[t]=s),n},be=e=>{e.stopImmediatePropagation(),e.preventDefault()},de=(e,t=-1)=>e?.reflected_ffi_timeout??t,{defineProperty:ye}=Object,[me,we]=r();let[ke,ve]=me(),Te=()=>ve,{Atomics:Me,MessageChannel:Ae,Worker:Se}=globalThis;if(le)we(ke);else{const e=new Map,t=(e,...t)=>{e.addEventListener(...t)};if("importScripts"in globalThis){t(globalThis,"message",e=>{be(e),we(ke,e.data)},{once:!0});const{wait:s}=Me,{parse:n}=JSON,r=t=>{const s=new XMLHttpRequest;try{if(s.timeout=3e3,s.open("POST",`${c}?sabayon`,!1),s.setRequestHeader("Content-Type","application/json"),s.send(`["${o}",${e.get(t)}]`),200===s.status)return s;throw s}catch{return s.abort(),r(t)}},a=(e,t)=>(e.set(n(t.responseText)),"ok");let o,c;Me={wait:(t,...n)=>e.has(t)?a(t,r(t)):s(t,...n)},ve=ve.then(e=>{[o,c]=e})}else{const s=[pe,Math.random()].join("-").replace(/\W/g,"-"),r=new BroadcastChannel("dc78209b-186c-4f83-80e9-406becb7d9f3");r.onmessage=async t=>{const[n,a,o]=t.data;if(a===s)for(const[t,[s,a]]of e)if(s===o){await a.promise;let e=t.length;for(;e--&&!t[e];);r.postMessage([n,t.slice(0,e+1)]);break}};const a=t=>{const[s,r,a]=t.data;e.set(r,[s,n()]),ye(t,"data",{value:a})};Ae=class extends Ae{constructor(){super(),t(this.port1,"message",a)}},Se=class extends Se{constructor(e,t){super(e,t),super.postMessage([s,c])}};const{notify:o}=Me;Me={notify(t,...s){const n=e.get(t);return n?(n[1].resolve(),0):o(t,...s)}};let c="",i=null;const l=(e,s)=>{let n,r=!0;e.getRegistration(c).then(t=>t??e.register(c,s)).then(function s(a){const{controller:o}=e;if(r=r&&!!o,n=a.installing||a.waiting||a.active,"activated"===n.state){if(r){if(o.scriptURL===c)return we(ke);a.unregister()}location.reload()}else t(n,"statechange",()=>s(a),{once:!0})})};Te=(e,t)=>{if(!i){const s=new URL(e,location.href);c=`${s.protocol}//${s.host}${s.pathname}`,l(navigator.serviceWorker,t),i=ve}return i}}}const xe="InstallTrigger"in globalThis?pe:"",Ee=e=>e,Ue=e=>e===t?"main":e===s?"worker":e;class Be extends Event{#e;constructor(e){super("message"),this.#e=e}get data(){return this.#e}}var Oe=e=>{const t=e?.transform,s=de(e),n=(e?.encoder||re)(fe),a=!1!==e?.transfer;return{Worker:class extends Se{constructor(e,o){const c=le?"":o?.serviceWorker||"",{notify:i}=c?Me:Atomics,{port1:l,port2:u}=new(c?Ae:MessageChannel),[h,p]=r(Ee),f=new Map,g=he(null);c&&Te(c);let b="";super(e,ue({type:"module"},o)),this.proxy=new Proxy(g,{get:(e,s)=>{if("then"===s)return;let n=f.get(s);return n||f.set(s,n=(...e)=>{const n=((e,t)=>{let s=ae;return e&&oe.has(t.at(-1)||ae)&&(s=t.pop(),oe.delete(s)),s})(a,e),[r,o]=h();return l.postMessage([r,s,t?e.map(t):e],n),((e,t)=>{if(b){const s=setTimeout(console.warn,3e3,`ðŸ’€ðŸ”’ - is proxy.${Ue(b)}() awaiting proxy.${Ue(t)}() ?`);e=e.then(e=>(clearTimeout(s),e),e=>(clearTimeout(s),Promise.reject(e)))}return e})(o,s)}),n},set:ge}),xe&&(le||c)&&super.addEventListener("message",e=>{const{data:t}=e;t?.ID===xe&&(be(e),l.dispatchEvent(new Be(t.data)))}),super.postMessage([xe,c,de(o,s)],[u]),l.addEventListener("message",async({data:e})=>{const s=e[0],r=typeof s;if("number"===r)p.apply(null,e);else if(b=e[1],await(async(e,t,s)=>{try{const n=await t[e[1]].apply(null,e[2]);e[1]=s?s(n):n,e[2]=null}catch(t){e[2]=t}})(e,g,t),b="","string"===r)l.postMessage(e);else{const t=e[2]||e[1],r=void 0===t?0:n(t,s.buffer);s[1]="number"==typeof r?r:await r,s[0]=1,i(s,0)}}),l.start()}},native:le,transfer:ce}};export{Oe as default};
