var e=Promise.withResolvers.bind(Promise);let t=0;const r=t++,s=t++,n=t++,a=t++,c=t++,o=t++,i=t++,l=t++,u=t++,f=t++,h=t++,g=t++,p=t++,y=t++,b=t++;t++;const d=t++,w=t++;const m=globalThis.ImageData||class{},S=new Map(Reflect.ownKeys(Symbol).map(e=>[Symbol[e],`@${String(e)}`])),k=e=>{switch(e[0]){case"@":return Symbol[e.slice(1)];case"#":return Symbol.for(e.slice(1));case"!":return Symbol(e.slice(1));default:return Symbol()}},v=e=>S.get(e)||((e,t)=>void 0===t?"?":void 0===Symbol.keyFor(e)?`!${t}`:`#${t}`)(e,e.description),A=Object.defineProperty,T=Object.assign,x=Array.from,B=Array.isArray,M=ArrayBuffer.isView,O=(e,t)=>[e,t],U=e=>e,E={},F=e=>(t,r=new Map)=>{for(let s=0,n=t.length;s<n;s++)t[s]=e(t[s],r);return t},P=([e,t])=>0===e?t:k(t),R=e=>"string"==typeof e?O(0,e):O(16,v(e)),{getPrototypeOf:N}=Object,{construct:_}=Reflect,{toStringTag:j}=Symbol,{toString:D}=E,L=(e,t=e[j])=>t in globalThis?t:L(_(N(e.constructor),[0])),z=(e,t)=>[t?e:x(new Uint8Array(e)),e.resizable?e.maxByteLength:0],$=/\[('|")?(.+?)\1\]/g,I=(e,t)=>e?.[t];var K=(e,t)=>t.replace($,".$2").split(".").reduce(I,e),J=(e,...t)=>t.map(V,e);function V(e){return"string"==typeof e?K(this,e):this[e]}const W=globalThis.Node||class{},{apply:q,construct:Y,defineProperty:C,deleteProperty:G,get:H,getOwnPropertyDescriptor:Q,getPrototypeOf:X,has:Z,isExtensible:ee,ownKeys:te,set:re,setPrototypeOf:se}=Reflect;var ne=({reflect:e=U,transform:t=U,remote:S=U,module:A=e=>import(e),buffer:x=!1,timeout:N=-1}=E)=>{const _=(t,r=new Map)=>{if(!B(t))return t;const[s,n]=t;switch(s){case 2:{if(null===n)return globalThis;let e=r.get(t);if(!e){e=n,r.set(t,n);for(const e in n)n[e]=_(n[e],r)}return e}case 4:return r.get(t)||(r.set(t,n),D(n,r));case 8:{let t=le.get(n),r=t?.deref();return r||(t&&fe.unregister(t),r=function(...t){S.apply(this,t);for(let e=0,r=t.length;e<r;e++)t[e]=j(t[e]);return e(o,n,j(this),t).then(_)},t=new WeakRef(r),le.set(n,t),fe.register(r,n,t)),r}case 16:return k(n);default:return 1&s?ae(n):n}},j=e=>{switch(typeof e){case"object":{if(null===e)break;if(e===globalThis)return ue;const r=t(e);return ge&&he.has(r)||r instanceof m?O(0,r):M(r)?O(68,((e,t)=>{const{BYTES_PER_ELEMENT:r,byteOffset:s,buffer:n,length:a}=e;return[L(e),z(n,t),s,a!==(n.byteLength-s)/r?a:0]})(r,x)):r instanceof ArrayBuffer?O(64,z(r,x)):O(B(r)?5:3,ne(r))}case"function":return O(9,ne(t(e)));case"symbol":return O(16,v(e));case"bigint":return O(32,e.toString())}return e},D=F(_),$=F(P),I=F(R),{clear:V,id:ne,ref:ae,unref:ce}=((e=0,t=new Map,r=new Map)=>({clear:()=>{t.clear(),r.clear()},id:s=>{let n=r.get(s);if(void 0===n){for(;t.has(n=e++););t.set(n,s),r.set(s,n)}return n},ref:e=>t.get(e),unref:e=>(r.delete(t.get(e)),t.delete(e))}))(),oe=/^(?:[0-9]+|length)$/,ie=-1<N,le=new Map,ue=O(2,null),fe=new FinalizationRegistry(t=>{le.delete(t),e(r,t)});let he,ge=!1;return{assign:T,gather:J,query:K,direct:e=>(ge||(ge=!0,he=new WeakSet),he.add(e),e),evaluate:(e,...t)=>q(e,null,t),reflect(e,t,...m){const S=null===t,k=S?globalThis:ae(t);switch(e){case f:{const e=P(m[0]),t=S&&"import"===e,r=t?A:H(k,e),s=j(r);if(!ie)return s;let n,a=t,c=k;if(!t&&!(c instanceof W||B(c)&&"string"==typeof e&&oe.test(e)))if(e in k){for(;!(n=Q(c,e))&&(c=X(c),c););a=!!n&&"value"in n}else a=!0;return[a,s]}case o:{const e=new Map;return j(q(k,_(m[0],e),D(m[1],e)))}case d:return re(k,P(m[0]),_(m[1]));case p:return Z(k,P(m[0]));case b:return I(te(k),le);case i:return j(Y(k,D(m[0])));case h:{const e=Q(k,P(m[0]));if(e)for(const t in e)e[t]=j(e[t]);return e}case l:return C(k,P(m[0]),_(m[1]));case u:return G(k,P(m[0]));case g:return j(X(k));case w:return se(k,_(m[0]));case s:return void T(k,_(m[0]));case n:{const e=_(m[0]),t=Function(`return(${e}).apply(null,arguments)`);return j(q(t,null,D(m[1])))}case a:for(let e,t=0,r=(m=$(m[0],le)).length;t<r;t++)e=m[t],m[t]=j("string"==typeof e?K(k,e):k[e]);return m;case c:return j(K(k,m[0]));case r:return ce(t);case y:return ee(k)}},terminate(){for(const e of le.values())fe.unregister(e);le.clear(),V()}}};let ae=0;const ce=ae++,oe=ae++,ie=ae++,le=ae++,ue=ae++,fe=ae++,he=ae++,ge=ae++,pe=ae++,ye=ae++,be=ae++,de=ae++,we=ae++,me=ae++,Se=ae++,ke=ae++,ve=ae++,Ae=ae++,Te=ae++,xe=ae++,Be=ae++,Me=ae++,Oe=ae++,Ue=ae++,Ee=ae++,Fe=ae++,Pe=new TextDecoder,Re=new TextEncoder,Ne=new ArrayBuffer(8),_e=new DataView(Ne),je=new Uint8Array(Ne),De=(e,t,r)=>(e.set(t,r),r),Le=e=>{je[0]=e[Ie++],je[1]=e[Ie++],je[2]=e[Ie++],je[3]=e[Ie++],je[4]=e[Ie++],je[5]=e[Ie++],je[6]=e[Ie++],je[7]=e[Ie++]},ze=e=>(je[0]=e[Ie++],je[1]=e[Ie++],je[2]=e[Ie++],je[3]=e[Ie++],_e.getUint32(0,!0)),$e=(e,t)=>{switch(e[Ie++]){case ue:return Le(e),_e.getFloat64(0,!0);case fe:return e[Ie++];case Be:{const r=De(t,Ie-1,{});for(let s=0,n=ze(e);s<n;s++)r[$e(e,t)]=$e(e,t);return r}case ke:{const r=De(t,Ie-1,[]);for(let s=0,n=ze(e);s<n;s++)r.push($e(e,t));return r}case Ue:{const r=Ie-1,s=$e(e,t);return De(t,r,new globalThis[s]($e(e,t)))}case ve:{const r=Ie-1,s=ze(e);return De(t,r,e.slice(Ie,Ie+=s).buffer)}case me:{const r=Ie-1,s=ze(e);return De(t,r,Pe.decode(e.slice(Ie,Ie+=s)))}case Ae:return De(t,Ie-1,new Date($e(e,t)));case xe:{const r=De(t,Ie-1,new Map);for(let s=0,n=ze(e);s<n;s++)r.set($e(e,t),$e(e,t));return r}case Oe:{const r=De(t,Ie-1,new Set);for(let s=0,n=ze(e);s<n;s++)r.add($e(e,t));return r}case Te:{const r=$e(e,t),s=$e(e,t),n=$e(e,t),a=new(globalThis[r]||Error)(s);return De(t,Ie-1,A(a,"stack",{value:n}))}case Ee:{const r=$e(e,t),s=$e(e,t),n=$e(e,t),a=$e(e,t),c=$e(e,t);return De(t,Ie-1,new m(r,s,n,{colorSpace:a,pixelFormat:c}))}case Me:{const r=$e(e,t),s=$e(e,t);return De(t,Ie-1,new RegExp(r,s))}case ce:return!1;case oe:return!0;case he:return NaN;case ge:return 1/0;case pe:return-1/0;case ye:return 0;case be:return-0;case le:return null;case de:return Le(e),_e.getBigInt64(0,!0);case we:return Le(e),_e.getBigUint64(0,!0);case Se:return k($e(e,t));case Fe:return t.get(ze(e));default:return}};let Ie=0;class Ke{static push(e,t){e.sync(!1),e._(t,t.length)}constructor(e,t){const r=[];this.l=0,this.o=r,this.v=new Uint8Array(e,t),this.push=r.push.bind(r)}get length(){return this.l+this.o.length}sync(e){const t=this.o,r=t.length;r&&this._(e?t:t.splice(0),r)}_(e,t){const{buffer:r,byteOffset:s}=this.v,n=this.l;this.l+=t,t+=s+n,r.byteLength<t&&r.grow(t),this.v.set(e,n)}}const{isNaN:Je,isFinite:Ve,isInteger:We}=Number,{ownKeys:qe}=Reflect,{is:Ye}=Object,Ce=(e,t,r)=>{const s=r.get(e),n=!s;return n?(_e.setUint32(0,t.length,!0),r.set(e,[je[0],je[1],je[2],je[3]])):t.push(Fe,s[0],s[1],s[2],s[3]),n},Ge=(e,t,r)=>{_e.setUint32(0,r,!0),e.push(t,je[0],je[1],je[2],je[3])},He=(e,t,r)=>{switch(typeof e){case"number":e&&Ve(e)?We(e)&&e<256&&-1<e?t.push(fe,e):(_e.setFloat64(0,e,!0),t.push(ue,je[0],je[1],je[2],je[3],je[4],je[5],je[6],je[7])):Je(e)?t.push(he):e?t.push(e<0?pe:ge):t.push(Ye(e,0)?ye:be);break;case"object":switch(!0){case null===e:t.push(le);break;case!Ce(e,t,r):break;case B(e):{const s=e.length;Ge(t,ke,s);for(let n=0;n<s;n++)He(e[n],t,r);break}case M(e):if(t.push(Ue),He(L(e),t,r),e=e.buffer,!Ce(e,t,r))break;case e instanceof ArrayBuffer:{const r=new Uint8Array(e);Ge(t,ve,r.length),Qe(t,r);break}case e instanceof Date:t.push(Ae),He(e.getTime(),t,r);break;case e instanceof Map:Ge(t,xe,e.size);for(const[s,n]of e)He(s,t,r),He(n,t,r);break;case e instanceof Set:Ge(t,Oe,e.size);for(const s of e)He(s,t,r);break;case e instanceof Error:t.push(Te),He(e.name,t,r),He(e.message,t,r),He(e.stack,t,r);break;case e instanceof m:t.push(Ee),He(e.data,t,r),He(e.width,t,r),He(e.height,t,r),He(e.colorSpace,t,r),He(e.pixelFormat,t,r);break;case e instanceof RegExp:t.push(Me),He(e.source,t,r),He(e.flags,t,r);break;default:if("toJSON"in e){const s=e.toJSON();He(s===e?null:s,t,r)}else{const s=qe(e),n=s.length;Ge(t,Be,n);for(let a=0;a<n;a++){const n=s[a];He(n,t,r),He(e[n],t,r)}}}break;case"string":if(Ce(e,t,r)){const r=Re.encode(e);Ge(t,me,r.length),Qe(t,r)}break;case"boolean":t.push(e?oe:ce);break;case"symbol":t.push(Se),He(v(e),t,r);break;case"bigint":{let r=de;9223372036854775807n<e?(_e.setBigUint64(0,e,!0),r=we):_e.setBigInt64(0,e,!0),t.push(r,je[0],je[1],je[2],je[3],je[4],je[5],je[6],je[7]);break}default:t.push(ie)}};let Qe=(e,t)=>{for(let r=e.push,s=0,n=t.length;s<n;s+=32767)r.apply(e,t.subarray(s,s+32767))};let Xe=class extends ArrayBuffer{value;transferToFixedLength(e){return this.value=new ArrayBuffer(e)}};const Ze=new Xe,et=(({byteOffset:e=0,Array:t=Ke}={})=>(r,s)=>{const n=new t(s,e);Qe=t.push,He(r,n,new Map);const a=n.length;return n.sync(!0),a})({Array:class extends Ke{constructor(e,t){super(e,t),this.e=[]}sync(e){if(super.sync(e),e){const e=this.l,t=this.v.byteOffset,r=this.v.buffer.transferToFixedLength(e+t),s=new Uint8Array(r,t);for(let e=this.e,t=0,r=0;r<e.length;r++){const n=e[r];s.set(n,t),t+=n.length}}return this}_(e,t){this.l+=t,this.e.push(e)}}}),tt=e=>et(e,Ze)?Ze.value:Ze,rt=e=>{return t=new Uint8Array(e),Ie=0,$e(t,new Map);var t};let{SharedArrayBuffer:st}=globalThis,nt=!0;try{new st(4,{maxByteLength:8})}catch(e){nt=!1,st=class extends ArrayBuffer{get growable(){return super.resizable}grow(e){super.resize(e)}}}nt?crypto.randomUUID():Math.random().toString(36).substring(2);const at=(e,t=-1)=>e?.reflected_ffi_timeout??t,{String:ct}=globalThis;var ot=(t,r)=>{const[s,n]=((t=e=>e)=>{const r=new Map;let s=0;return[()=>{let n;do{n=t(s++)}while(r.has(n));const a=e();return r.set(n,a),[n,a.promise]},(e,t,s)=>{const n=r.get(e);r.delete(e),s?n?.reject(s):n?.resolve(t)}]})(ct),a=r?.import||(e=>import(e)),c=new Set;let o,i,l=e=>e,u=-1;return{direct:e=>l(e),onclose:()=>{for(const e of c)e();c.clear(),u=0,i?.()},onmessage:async e=>{if(u<0){u=0;try{const f=rt(e);if(B(f)&&"=95fbed49-ws"===f.at(0)){u=1;const{direct:e,reflect:f,terminate:h}=ne({...r,module:a,buffer:!0,timeout:at(r),reflect(...e){const[r,a]=s();return t.send(tt([r,e])),c.add(n.bind(null,r)),a}});o=f,l=e,i=h}}catch(e){}}else if(u>0){const r=rt(e);if("string"==typeof r[0])n.apply(null,r);else{try{r[1]=await o(...r[1])}catch(e){r[1]=null,r[2]=e}t.send(tt(r))}}}}};export{ot as default};
