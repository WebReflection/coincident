const e="dbf1617e",t="="+e,r="-"+e,s=t+"-ws",n=r+"-ws";let o=0;const a=o++,i=o++,c=o++,l=o++,u=o++,f=o++,p=o++,h=o++,g=o++,y=o++,d=o++,w=o++,b=o++,m=o++,v=o++;o++;const x=o++,M=o++,S=new Map(Reflect.ownKeys(Symbol).map(e=>[Symbol[e],`@${String(e)}`])),$=e=>{switch(e[0]){case"@":return Symbol[e.slice(1)];case"#":return Symbol.for(e.slice(1));case"!":return Symbol(e.slice(1));default:return Symbol()}},P=e=>S.get(e)||((e,t)=>void 0===t?"?":void 0===Symbol.keyFor(e)?`!${t}`:`#${t}`)(e,e.description),A=Object.defineProperty,B=Object.assign,T=Array.isArray,O=ArrayBuffer.isView,k=(e,t)=>[e,t],E=e=>e,L=[],R={},U=function(){},_=e=>(t,r=new Map)=>{for(let s=0,n=t.length;s<n;s++)t[s]=e(t[s],r);return t},j=([e,t])=>0===e?t:$(t),D=e=>"string"==typeof e?k(0,e):k(16,P(e)),{getPrototypeOf:I}=Object,{toString:W}=R,q=(e,t=W.call(e).slice(8,-1))=>t in globalThis?t:q(I(e)||R),K=(e,t)=>new ArrayBuffer(e,{maxByteLength:t}),F=([e,t],r)=>{const s=r?e.byteLength:e.length;if(r){if(t){const r=K(s,t);new Uint8Array(r).set(new Uint8Array(e)),e=r}}else{const r=t?K(s,t):new ArrayBuffer(s);new Uint8Array(r).set(e),e=r}return e};const N=/\[('|")?(.+?)\1\]/g,z=(e,t)=>e?.[t];var C=e=>{const t=[],r=e=>{const r=t.splice(e);for(;e<r.length;)r[e++].delete(r[e++])};return class s extends Map{static keys=Symbol();static proto=Symbol();drop(e,t){return e!==s.proto&&super.delete(s.keys),super.delete(e),t}set(s,n){return((s,n)=>{t.push(s,n)<3&&setTimeout(r,e,0)})(super.set(s,n),s),n}}},H=({reflect:e=E,transform:t=E,released:r=E,buffer:s=!1,timeout:n=-1}=R)=>{const o=_(j),S=_(D),A=e=>{if(!T(e))return e;const[t,r]=e;if(1&t)return K(t,r);switch(t){case 2:return ie;case 0:return r;case 16:return $(r);case 32:return BigInt(r);case 68:return(([e,t,r,s],n)=>{const o=F(t,n),a=globalThis[e];return s?new a(o,r,s):new a(o,r)})(r,s);case 64:return F(r,s)}},I=(e,r=new Map)=>{switch(typeof e){case"object":{if(null===e)break;if(e===globalThis)return ae;if(oe in e)return Q;let s=r.get(e);if(!s){const n=t(e);if(Z||!G.has(n)){if(T(n)){const t=[];s=k(4,t),r.set(e,s);for(let e=0,s=n.length;e<s;e++)t[e]=I(n[e],r);return s}if(!(O(n)||n instanceof ArrayBuffer||"Object"!==q(n))){const t={};s=k(2,t),r.set(e,s);try{for(const e in n)break}catch{return s}for(const e in n)t[e]=I(n[e],r);return s}}s=k(0,n),r.set(e,s)}return s}case"function":{if(oe in e)return Q;let s=r.get(e);if(!s){const n=t(e);s=k(8,te(n)),r.set(e,s)}return s}case"symbol":return k(16,P(e))}return e},W=_(I),K=(e,t)=>{let r=ne.get(t),s=r?.deref();return s||(r&&ce.unregister(r),s=9===e?new Proxy(U,new Y(e,t)):new Proxy(3===e?R:L,new X(e,t)),r=new WeakRef(s),ne.set(t,r),ce.register(s,t,r)),s},H=e=>{switch(typeof e){case"object":if(null===e)break;case"function":return oe in e}return!1},V=-1<n,J=V?C(n):Map;class X{constructor(e,t){this.t=e,this.v=t,V&&(this.$=new J)}get(t,r){if(V&&this.$.has(r))return this.$.get(r);const s=e(y,this.v,D(r));return V?s[0]?this.$.set(r,A(s[1])):A(s[1]):A(s)}set(t,r,s){const n=e(x,this.v,D(r),I(s));return V?this.$.drop(r,n):n}has(t,r){return r===oe?(Q=[this.t,this.v],!0):e(b,this.v,D(r))}_oK(){return o(e(v,this.v),ne)}ownKeys(e){return V?this.$.has(J.keys)?this.$.get(J.keys):this.$.set(J.keys,this._oK()):this._oK()}getOwnPropertyDescriptor(t,r){const s=A(e(d,this.v,D(r)));if(s)for(const e in s)s[e]=A(s[e]);return s}defineProperty(t,r,s){const n=e(h,this.v,D(r),I(s));return V?this.$.drop(r,n):n}deleteProperty(t,r){const s=e(g,this.v,D(r));return V?this.$.drop(r,s):s}_gPO(){return A(e(w,this.v))}getPrototypeOf(e){return V?this.$.has(J.proto)?this.$.get(J.proto):this.$.set(J.proto,this._gPO()):this._gPO()}setPrototypeOf(t,r){const s=e(M,this.v,I(r));return V?this.$.drop(J.proto,s):s}isExtensible(t){return e(m,this.v)}preventExtensions(e){return!1}}class Y extends X{construct(t,r){return A(e(p,this.v,W(r)))}apply(t,r,s){const n=new Map;return A(e(f,this.v,I(r,n),W(s,n)))}get(e,t){switch(t){case"apply":return(t,r)=>this.apply(e,t,r);case"call":return(t,...r)=>this.apply(e,t,r);default:return super.get(e,t)}}}let G,Q,Z=!0;const{apply:ee}=Reflect,{id:te,ref:re,unref:se}=((e=0,t=new Map,r=new Map)=>({clear:()=>{t.clear(),r.clear()},id:s=>{let n=r.get(s);if(void 0===n){for(;t.has(n=e++););t.set(n,s),r.set(s,n)}return n},ref:e=>t.get(e),unref:e=>(r.delete(t.get(e)),t.delete(e))}))(),ne=new Map,oe=Symbol("reflected-ffi"),ae=k(2,null),ie=new Proxy(R,new X(2,null)),ce=new FinalizationRegistry(t=>{ne.delete(t),e(a,t)});return{global:ie,isProxy:H,assign(t,...r){const s=H(t),n=B(s?{}:t,...r);return s&&e(i,Q[1],I(n)),t},direct:e=>(Z&&(Z=!1,G=new WeakSet),G.add(e),e),evaluate:(t,...r)=>A(e(c,null,function(e=this){return String(e).replace(/^(async\s*)?(\bfunction\b)?(.*?)\(/,(e,t,r,s)=>s&&!r?`${t||""}function ${s}(`:e)}(t),W(r))),gather(t,...r){const s=H(t),n=s?A:e=>t[e];s&&(r=e(l,Q[1],S(r,ne)));for(let e=0;e<r.length;e++)r[e]=n(r[e]);return r},query:(t,r)=>H(t)?A(e(u,Q[1],r)):((e,t)=>t.replace(N,".$2").split(".").reduce(z,e))(t,r),reflect:async(e,t,...s)=>{switch(e){case f:{const[e,r]=s;for(let e=0,t=r.length;e<t;e++)r[e]=A(r[e]);return I(await ee(re(t),A(e),r))}case a:return r(re(t)),se(t)}}}};let V=0;const J=V++,X=V++;V++;const Y=V++,G=V++,Q=V++,Z=V++,ee=V++,te=V++,re=V++,se=V++,ne=V++,oe=V++,ae=V++,ie=V++,ce=V++,le=V++,ue=V++,fe=V++,pe=V++,he=V++,ge=V++,ye=V++,de=V++,we=V++,be=V++;const me=globalThis.ImageData||class{},ve=new TextDecoder;new TextEncoder;const xe=new ArrayBuffer(8),Me=new DataView(xe),Se=new Uint8Array(xe),$e=(e,t,r)=>(e.set(t,r),r),Pe=e=>{Se[0]=e[Te++],Se[1]=e[Te++],Se[2]=e[Te++],Se[3]=e[Te++],Se[4]=e[Te++],Se[5]=e[Te++],Se[6]=e[Te++],Se[7]=e[Te++]},Ae=e=>(Se[0]=e[Te++],Se[1]=e[Te++],Se[2]=e[Te++],Se[3]=e[Te++],Me.getUint32(0,!0)),Be=(e,t)=>{switch(e[Te++]){case G:return Pe(e),Me.getFloat64(0,!0);case Q:return e[Te++];case he:{const r=$e(t,Te-1,{});for(let s=0,n=Ae(e);s<n;s++)r[Be(e,t)]=Be(e,t);return r}case ce:{const r=$e(t,Te-1,[]);for(let s=0,n=Ae(e);s<n;s++)r.push(Be(e,t));return r}case de:{const r=Te-1,s=Be(e,t);return $e(t,r,new globalThis[s](Be(e,t)))}case le:{const r=Te-1,s=Ae(e);return $e(t,r,e.slice(Te,Te+=s).buffer)}case ae:{const r=Te-1,s=Ae(e);return $e(t,r,ve.decode(e.slice(Te,Te+=s)))}case ue:return $e(t,Te-1,new Date(Be(e,t)));case pe:{const r=$e(t,Te-1,new Map);for(let s=0,n=Ae(e);s<n;s++)r.set(Be(e,t),Be(e,t));return r}case ye:{const r=$e(t,Te-1,new Set);for(let s=0,n=Ae(e);s<n;s++)r.add(Be(e,t));return r}case fe:{const r=Be(e,t),s=Be(e,t),n=Be(e,t),o=new(globalThis[r]||Error)(s);return $e(t,Te-1,A(o,"stack",{value:n}))}case we:{const r=Be(e,t),s=Be(e,t),n=Be(e,t),o=Be(e,t),a=Be(e,t);return $e(t,Te-1,new me(r,s,n,{colorSpace:o,pixelFormat:a}))}case ge:{const r=Be(e,t),s=Be(e,t);return $e(t,Te-1,new RegExp(r,s))}case J:return!1;case X:return!0;case Z:return NaN;case ee:return 1/0;case te:return-1/0;case re:return 0;case se:return-0;case Y:return null;case ne:return Pe(e),Me.getBigInt64(0,!0);case oe:return Pe(e),Me.getBigUint64(0,!0);case ie:return $(Be(e,t));case be:return t.get(Ae(e));default:return}};let Te=0;const Oe=({byteOffset:e=0}={})=>(t,r)=>{return s=new Uint8Array(r,e,t),Te=0,Be(s,new Map);var s};var ke=Promise.withResolvers.bind(Promise),Ee=(e=e=>e)=>{const t=new Map;let r=0;return[()=>{let s;do{s=e(r++)}while(t.has(s));const n=ke();return t.set(s,n),[s,n.promise]},(e,r,s)=>{const n=t.get(e);t.delete(e),s?n?.reject(s):n?.resolve(r)}]};const Le=[],Re=new WeakSet,Ue=(...e)=>(Re.add(e),e);let{SharedArrayBuffer:_e}=globalThis,je=!0;try{new _e(4,{maxByteLength:8})}catch(e){je=!1,_e=class extends ArrayBuffer{get growable(){return super.resizable}grow(e){super.resize(e)}}}const{create:De}=Object,Ie=`coincident-${je?crypto.randomUUID():Math.random().toString(36).substring(2)}`,We=2*Int32Array.BYTES_PER_ELEMENT,qe={byteOffset:We},Ke=(e,t,r)=>{const s="then"!==t;return s&&(e[t]=r),s},Fe=e=>{e.stopImmediatePropagation(),e.preventDefault()},[Ne,ze]=Ee();let[Ce,He]=Ne(),Ve=()=>He,Je=()=>{},{Atomics:Xe,MessagePort:Ye,SharedArrayBuffer:Ge,postMessage:Qe}=globalThis;if(je)ze(Ce);else{Ge=_e;const e=new Map,t=(e,...t)=>{e.addEventListener(...t)};if("importScripts"in globalThis){Je=t=>{e.set(t,null)};const r=t=>{const r=t[0],s=f++;return e.set(r,s),[s,r,t]},s=Qe;Qe=function(e,t){if(u){const n={ID:e.ID,data:r(e.data)};s(n,t)}else He.then(()=>this.postMessage(e,t))},Ye=class extends Ye{postMessage(e,t){u?super.postMessage(r(e),t):He.then(()=>this.postMessage(e,t))}},t(globalThis,"message",e=>{Fe(e),ze(Ce,e.data)},{once:!0});const{wait:n}=Xe,{parse:o}=JSON,a=t=>{const r=new XMLHttpRequest;try{if(r.timeout=3e3,r.open("POST",`${l}?sabayon`,!1),r.setRequestHeader("Content-Type","application/json"),r.send(`["${c}",${e.get(t)}]`),200===r.status)return r;throw r}catch{return r.abort(),a(t)}},i=(e,t)=>(e.set(o(t.responseText)),"ok");Xe={wait:(t,...r)=>e.has(t)?i(t,a(t)):n(t,...r)};let c,l,u=!1,f=Math.random();He=He.then(e=>{[c,l]=e,u=!0})}else{const r=[Ie,Math.random()].join("-").replace(/\W/g,"-"),s=new BroadcastChannel("dc78209b-186c-4f83-80e9-406becb7d9f3");s.onmessage=async t=>{const[n,o,a]=t.data;if(o===r)for(const[t,[r,o]]of e)if(r===a){await o.promise;let e=t.length;for(;e--&&!t[e];);s.postMessage([n,t.slice(0,e+1)]);break}};const{notify:n}=Xe;Xe={notify(t,...r){const s=e.get(t);return s?(s[1].resolve(),0):n(t,...r)}};let o="",a=null;const i=(e,r)=>{let s,n=!0;e.getRegistration(o).then(t=>t??e.register(o,r)).then(function r(a){const{controller:i}=e;if(n=n&&!!i,s=a.installing||a.waiting||a.active,"activated"===s.state){if(n){if(i.scriptURL===o)return ze(Ce);a.unregister()}location.reload()}else t(s,"statechange",()=>r(a),{once:!0})})};Ve=(e,t)=>{if(!a){const r=new URL(e,location.href);o=`${r.protocol}//${r.host}${r.pathname}`,i(navigator.serviceWorker,t),a=He}return a}}}const{setPrototypeOf:Ze}=Reflect;let{postMessage:et}=globalThis;const tt=ke(),rt=Ye.prototype;addEventListener("message",e=>{Fe(e);const[t,r,s]=e.data,[n]=e.ports;r&&(Ze(n,rt),t&&(et=Qe)),tt.resolve([t,r,s,n])},{once:!0});var st=async e=>{const[t,r,s,n]=await Ve().then(()=>tt.promise),o=!!t,a=je||!!r,i=e?.transform,c=(e?.decoder||Oe)(qe),l=!1!==e?.transfer;let u,f,p,h;if(a){const t=new(r?Ge:SharedArrayBuffer)(e?.minByteLength||32767,{maxByteLength:e?.maxByteLength||16777216});u=new Int32Array(t),r?(({wait:h}=Xe),Je(u)):(({load:f,pause:p,wait:h}=Atomics),p&&(h=(e,t)=>{do{p()}while(f(e,t)<1)}))}const[g,y]=Ee(String),d=new Map,w=De(null),b=new Proxy(w,{get(e,r){if("then"===r)return;let s=d.get(r);return s||d.set(r,s=(...e)=>{const s=((e,t)=>{let r=Le;return e&&Re.has(t.at(-1)||Le)&&(r=t.pop(),Re.delete(r)),r})(l,e),f=[u,r,i?e.map(i):e];if(a){o?et({ID:t,data:f},s):n.postMessage(f,s),h(u,0),u[0]=0;const e=u[1]?c(u[1],u.buffer):void 0;if(e instanceof Error)throw e;return e}{const[e,t]=g();return f[0]=e,n.postMessage(f,s),t}}),s},set:Ke});return n.addEventListener("message",async({data:e})=>{"string"==typeof e[0]?y.apply(null,e):(await(async(e,t,r)=>{try{const s=await t[e[1]].apply(null,e[2]);e[1]=r?r(s):s,e[2]=null}catch(t){e[2]=t}})(e,w,i),n.postMessage(e))}),n.start(),{native:je,proxy:b,ffi_timeout:s,sync:a,transfer:Ue}},nt=async e=>{const o=await(async e=>{const s=await st({...e,decoder:e?.decoder||Oe}),n=H({...e,buffer:!0,reflect:s.proxy[t],timeout:s.ffi_timeout});return s.proxy[r]=n.reflect,{...s,window:n.global,isWindowProxy:n.isProxy,ffi:{assign:n.assign,direct:n.direct,evaluate:n.evaluate,gather:n.gather,query:n.query}}})(e),a=H({...e,buffer:!0,timeout:o.ffi_timeout,reflect:o.proxy[s]});o.proxy[n]=a.reflect;const i={};for(const e in o.ffi)i[e]=a[e];return{...o,server:a.global,isServerProxy:a.isProxy,ffi:{...o.ffi,window:o.ffi,server:i}}};export{nt as default};
